<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>PolyBug - ë©€í‹°ì½”ì¸ íŠ¸ë ˆì´ë”© ë´‡</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background: #0d0d0d; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; font-size: 14px; }

        header {
            background: #111; border-bottom: 1px solid #222;
            padding: 10px 20px; display: flex; align-items: center; gap: 12px;
        }
        header h1 { font-size: 17px; color: #fff; }
        .badge { padding: 3px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        .badge.live { background: #1a3a1a; color: #4caf50; border: 1px solid #4caf50; }
        .badge.dryrun { background: #2a2a1a; color: #ff9800; border: 1px solid #ff9800; }

        .btn { padding: 6px 14px; border: none; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: bold; }
        .btn:hover { opacity: 0.8; }

        /* íƒ­ ë°” */
        .tf-tabs {
            display: flex; gap: 0; background: #111; border: 1px solid #222; border-radius: 10px; padding: 3px; margin-bottom: 12px;
        }
        .tf-tab {
            flex: 1; padding: 10px 0; text-align: center; border-radius: 8px; cursor: pointer;
            font-size: 14px; font-weight: bold; color: #555; transition: all 0.2s; border: none; background: transparent;
        }
        .tf-tab:hover { color: #888; }
        .tf-tab.active-1h { background: #1a2a1a; color: #4caf50; border: 1px solid #2a4a2a; }
        .tf-tab.active-15m { background: #1a1a2a; color: #ce93d8; border: 1px solid #2a1a3a; }
        .tf-tab.active-5m { background: #1a1a0a; color: #ffd54f; border: 1px solid #3a3a0a; }
        .tf-tab .tab-count { font-size: 10px; font-weight: normal; margin-left: 4px; opacity: 0.6; }

        /* ë ˆì´ì•„ì›ƒ */
        .layout { display: grid; grid-template-columns: 1fr 300px; height: calc(100vh - 48px); }
        .main { overflow-y: auto; padding: 14px; display: flex; flex-direction: column; gap: 10px; }
        .sidebar { background: #111; border-left: 1px solid #222; display: flex; flex-direction: column; }

        .card { background: #161616; border: 1px solid #222; border-radius: 8px; padding: 12px; }
        .card h3 { font-size: 12px; color: #666; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }

        .ind-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .ind-item { background: #111; border: 1px solid #222; border-radius: 6px; padding: 10px; text-align: center; }
        .ind-label { font-size: 10px; color: #555; margin-bottom: 4px; }
        .ind-value { font-size: 17px; font-weight: bold; color: #fff; }
        .ind-sub { font-size: 11px; color: #666; margin-top: 2px; }
        .up { color: #4caf50 !important; }
        .down { color: #f44336 !important; }
        .neutral { color: #ff9800 !important; }

        .stat-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .stat-item { background: #111; border-radius: 6px; padding: 10px; text-align: center; border: 1px solid #222; }
        .stat-num { font-size: 20px; font-weight: bold; color: #fff; }
        .stat-label { font-size: 11px; color: #555; margin-top: 3px; }

        .pattern-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        .pattern-item { background: #111; border-radius: 6px; padding: 8px 10px; display: flex; justify-content: space-between; border: 1px solid #222; }
        .pattern-label { font-size: 11px; color: #888; }
        .pattern-value { font-size: 12px; font-weight: bold; color: #64b5f6; }

        table { width: 100%; border-collapse: collapse; font-size: 11px; }
        th { background: #1a1a1a; color: #555; padding: 7px 6px; text-align: left; border-bottom: 1px solid #222; }
        td { padding: 7px 6px; border-bottom: 1px solid #161616; }
        tr:hover td { background: #1a1a1a; }
        .tag { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; }
        .tag-up { background: #1a3a1a; color: #4caf50; }
        .tag-down { background: #3a1a1a; color: #f44336; }
        .tag-hold { background: #2a2a2a; color: #888; }
        .tag-win { background: #1a3a1a; color: #4caf50; }
        .tag-lose { background: #3a1a1a; color: #f44336; }
        .tag-pending { background: #2a2a1a; color: #ff9800; }

        .log-header { padding: 12px 14px; border-bottom: 1px solid #222; }
        .log-header h3 { font-size: 13px; color: #fff; }
        #logBox { flex: 1; overflow-y: auto; padding: 8px 10px; font-family: 'JetBrains Mono', 'Fira Code', monospace; font-size: 11px; }
        .log-line { padding: 3px 0; border-bottom: 1px solid #111; line-height: 1.4; }
        .log-count { padding: 6px 14px; border-top: 1px solid #222; font-size: 10px; color: #444; text-align: center; }

        .ev-bar { height: 4px; background: #1a1a1a; border-radius: 2px; margin-top: 4px; overflow: hidden; }
        .ev-fill { height: 100%; border-radius: 2px; transition: width 0.3s; }

        .tab-content { display: none; flex-direction: column; gap: 10px; }
        .tab-content.active { display: flex; }

        /* ë°°íŒ… í–‰ í´ë¦­ í™•ì¥ */
        tr.trade-row { cursor: pointer; transition: background 0.15s; }
        tr.trade-row:hover td { background: #1a1a2a !important; }
        tr.trade-row.expanded td { background: #111 !important; border-bottom: none; }
        tr.trade-detail-row td { padding: 0 !important; border-bottom: 1px solid #222; }
        .trade-detail {
            background: #0d1117; border: 1px solid #1a1a2e; border-radius: 6px;
            margin: 4px 6px 10px 6px; padding: 14px; animation: slideDown 0.2s ease-out;
        }
        @keyframes slideDown { from { opacity:0; max-height:0; } to { opacity:1; max-height:500px; } }
        .detail-section { margin-bottom: 10px; }
        .detail-section:last-child { margin-bottom: 0; }
        .detail-label { font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
        .detail-reason { font-size: 12px; color: #ccc; line-height: 1.6; white-space: pre-wrap; word-break: break-word; }
        .detail-meta { display: flex; gap: 12px; flex-wrap: wrap; }
        .detail-chip { font-size: 10px; padding: 3px 8px; border-radius: 4px; background: #1a1a1a; border: 1px solid #222; color: #888; }
        .detail-reflection { font-size: 11px; color: #ff9800; line-height: 1.5; padding: 8px; background: #1a1a0d; border-radius: 4px; border: 1px solid #2a2a1a; }
    </style>
</head>
<body>

<header>
    <h1>ğŸ¤– PolyBug</h1>
    <span class="badge dryrun">DRY-RUN</span>
    <span class="badge live">LIVE</span>
    <span id="pnlTotal" style="font-size:12px; color:#888; margin-left:4px;">PNL: $0.00</span>
    <span id="balanceDisplay" style="font-size:13px; font-weight:bold; color:#4caf50; margin-left:8px; padding:3px 10px; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px;">ğŸ’ $50.00</span>
    <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <span id="tickDot" style="font-size:10px; color:#333;">â—</span>
        <div id="headerBtns1h">
            <button class="btn" style="background:#2a1a00; color:#f7931a; border:1px solid #f7931a;" onclick="runOnce('BTC','1H')">âš¡ BTC</button>
            <button class="btn" style="background:#0a0a2a; color:#627eea; border:1px solid #627eea;" onclick="runOnce('ETH','1H')">âš¡ ETH</button>
            <button class="btn" style="background:#0a1a1a; color:#00d4aa; border:1px solid #00d4aa;" onclick="runOnce('SOL','1H')">âš¡ SOL</button>
            <button class="btn" style="background:#0a0a1a; color:#00aaff; border:1px solid #00aaff;" onclick="runOnce('XRP','1H')">âš¡ XRP</button>
        </div>
        <div id="headerBtns15m" style="display:none;">
            <button class="btn" style="background:#1a0a1a; color:#ce93d8; border:1px solid #8e24aa;" onclick="runOnce('BTC','15M')">âš¡ BTC 15M</button>
            <button class="btn" style="background:#1a0a1a; color:#ce93d8; border:1px solid #8e24aa;" onclick="runOnce('ETH','15M')">âš¡ ETH 15M</button>
            <button class="btn" style="background:#1a0a1a; color:#ce93d8; border:1px solid #8e24aa;" onclick="runOnce('SOL','15M')">âš¡ SOL 15M</button>
            <button class="btn" style="background:#1a0a1a; color:#ce93d8; border:1px solid #8e24aa;" onclick="runOnce('XRP','15M')">âš¡ XRP 15M</button>
        </div>
        <div id="headerBtns5m" style="display:none;">
            <button class="btn" style="background:#1a1a0a; color:#ffd54f; border:1px solid #f9a825;" onclick="runOnce('BTC','5M')">âš¡ BTC 5M</button>
            <button class="btn" style="background:#1a1a0a; color:#ffd54f; border:1px solid #f9a825;" onclick="runOnce('ETH','5M')">âš¡ ETH 5M</button>
            <button class="btn" style="background:#1a1a0a; color:#ffd54f; border:1px solid #f9a825;" onclick="runOnce('SOL','5M')">âš¡ SOL 5M</button>
            <button class="btn" style="background:#1a1a0a; color:#ffd54f; border:1px solid #f9a825;" onclick="runOnce('XRP','5M')">âš¡ XRP 5M</button>
        </div>
    </div>
</header>

<div class="layout">
<div class="main">

    <!-- ===== íƒ­ ë°” ===== -->
    <div class="tf-tabs">
        <button id="tfTab1h" class="tf-tab active-1h" onclick="switchTimeframe('1H')">â± 1ì‹œê°„<span class="tab-count" id="tab1hCount"></span></button>
        <button id="tfTab15m" class="tf-tab" onclick="switchTimeframe('15M')">â± 15ë¶„<span class="tab-count" id="tab15mCount"></span></button>
        <button id="tfTab5m" class="tf-tab" onclick="switchTimeframe('5M')">â± 5ë¶„<span class="tab-count" id="tab5mCount"></span></button>
    </div>

    <!-- ===== ê³µí†µ: ì‹¤ì‹œê°„ í˜„í™© ===== -->
    <div class="card" style="border-color:#2a1a00;">
        <h3>âš¡ ì˜¤ì¦ˆ ê°­ ëª¨ë‹ˆí„° <span style="font-size:10px; color:#444;" id="gapTime">ì‹¤ì‹œê°„</span>
            <span id="gapAlertBadge" style="display:none; margin-left:8px; padding:2px 8px; border-radius:10px; background:#ff9800; color:#000; font-size:10px; font-weight:bold;">ê¸°íšŒ!</span>
        </h3>
        <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:8px;" id="gapGrid">
            <!-- JSë¡œ ì±„ì›€ -->
        </div>
        <div style="margin-top:8px; padding:8px 12px; background:#0d1117; border:1px solid #1a1a2e; border-radius:6px;">
            <div style="font-size:10px; color:#555; line-height:1.5;">
                ğŸ’¡ <span style="color:#4caf50;">ìˆœë°©í–¥</span>=ì‹œì¥ì´ ëŠ¦ë‹¤(ì˜¤ì¦ˆ<ì¶”ì •) |
                <span style="color:#e040fb;">ì—­ë°©í–¥</span>=ì‹œì¥ì´ ê³¼ì‰ë°˜ì‘(ì˜¤ì¦ˆ 70%+ì¸ë° ì‹¤ì œ í™•ë¥  ë‚®ìŒâ†’ë°˜ëŒ€ìª½ì´ ì‹¸ë‹¤) |
                ê°­ í™•ì¸ 3ì´ˆ ì—°ì† â†’ ìë™ë°°íŒ… | ğŸ”¥=íŠ¸ë¦¬ê±° ì„ë°•
            </div>
            <!-- â­ V5: ì‹¤ì‹œê°„ ìŠ¤ìº” ë¡œê·¸ -->
            <div style="margin-top:8px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                    <span style="font-size:10px; color:#666;">ğŸ” ìŠ¤ìºë„ˆ í™œë™ ë¡œê·¸</span>
                    <span style="font-size:9px; color:#333;" id="scanLogTime">-</span>
                </div>
                <div style="background:#0a0a0a; border:1px solid #1a1a1a; border-radius:6px; padding:8px; max-height:200px; overflow-y:auto;" id="scanLogBox">
                    <div style="font-size:10px; color:#555;">ìŠ¤ìº” ë¡œê·¸ ë¡œë”©ì¤‘...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== ê³µí†µ: ì‹¤ì‹œê°„ í˜„í™© ===== -->
    <div class="card">
        <h3>ğŸ“¡ ì‹¤ì‹œê°„ í˜„í™© <span style="font-size:10px; color:#444;" id="tickTime"></span></h3>
        <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
            <div id="btcPriceCard" style="background:#111; border:1px solid #222; border-radius:8px; padding:14px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <span style="color:#f7931a; font-weight:bold; font-size:14px;">â‚¿ BTC</span>
                    <span id="btcDirection" style="font-size:22px; font-weight:bold;">-</span>
                </div>
                <div style="display:flex; gap:8px; margin-bottom:10px;">
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:10px; color:#555;" class="open-label">ì •ì‹œ ì‹œì‘ê°€</div>
                        <div id="btcHourOpen" style="font-size:16px; font-weight:bold; color:#888;">-</div>
                    </div>
                    <div style="flex:0 0 30px; display:flex; align-items:center; justify-content:center;">
                        <span id="btcArrow" style="font-size:20px; color:#666;">â†’</span>
                    </div>
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:10px; color:#555;">í˜„ì¬ê°€</div>
                        <div id="btcNowPrice" style="font-size:16px; font-weight:bold; color:#fff;">-</div>
                    </div>
                </div>
                <div id="btcPriceBar" style="height:6px; border-radius:3px; background:#1a1a1a; overflow:hidden; margin-bottom:6px;">
                    <div id="btcPriceFill" style="height:100%; width:50%; border-radius:3px; transition:all 0.5s;"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:11px;">
                    <span id="btcPriceDiff" style="color:#666;">-</span>
                    <span id="btcPricePct" style="color:#666;">-</span>
                </div>
            </div>
            <div id="ethPriceCard" style="background:#111; border:1px solid #222; border-radius:8px; padding:14px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                    <span style="color:#627eea; font-weight:bold; font-size:14px;">Î ETH</span>
                    <span id="ethDirection" style="font-size:22px; font-weight:bold;">-</span>
                </div>
                <div style="display:flex; gap:8px; margin-bottom:10px;">
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:10px; color:#555;" class="open-label">ì •ì‹œ ì‹œì‘ê°€</div>
                        <div id="ethHourOpen" style="font-size:16px; font-weight:bold; color:#888;">-</div>
                    </div>
                    <div style="flex:0 0 30px; display:flex; align-items:center; justify-content:center;">
                        <span id="ethArrow" style="font-size:20px; color:#666;">â†’</span>
                    </div>
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:10px; color:#555;">í˜„ì¬ê°€</div>
                        <div id="ethNowPrice" style="font-size:16px; font-weight:bold; color:#fff;">-</div>
                    </div>
                </div>
                <div id="ethPriceBar" style="height:6px; border-radius:3px; background:#1a1a1a; overflow:hidden; margin-bottom:6px;">
                    <div id="ethPriceFill" style="height:100%; width:50%; border-radius:3px; transition:all 0.5s;"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:11px;">
                    <span id="ethPriceDiff" style="color:#666;">-</span>
                    <span id="ethPricePct" style="color:#666;">-</span>
                </div>
            </div>
            <div id="solPriceCard" style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                    <span style="color:#00d4aa; font-weight:bold; font-size:13px;">â— SOL</span>
                    <span id="solDirection" style="font-size:18px; font-weight:bold;">-</span>
                </div>
                <div style="display:flex; gap:6px; margin-bottom:8px;">
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:9px; color:#555;" class="open-label">ì •ì‹œ ì‹œì‘ê°€</div>
                        <div id="solHourOpen" style="font-size:14px; font-weight:bold; color:#888;">-</div>
                    </div>
                    <div style="flex:0 0 20px; display:flex; align-items:center; justify-content:center;">
                        <span id="solArrow" style="font-size:16px; color:#666;">â†’</span>
                    </div>
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:9px; color:#555;">í˜„ì¬ê°€</div>
                        <div id="solNowPrice" style="font-size:14px; font-weight:bold; color:#fff;">-</div>
                    </div>
                </div>
                <div id="solPriceBar" style="height:5px; border-radius:3px; background:#1a1a1a; overflow:hidden; margin-bottom:4px;">
                    <div id="solPriceFill" style="height:100%; width:50%; border-radius:3px; transition:all 0.5s;"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:10px;">
                    <span id="solPriceDiff" style="color:#666;">-</span>
                    <span id="solPricePct" style="color:#666;">-</span>
                </div>
            </div>
            <div id="xrpPriceCard" style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                    <span style="color:#00aaff; font-weight:bold; font-size:13px;">âœ• XRP</span>
                    <span id="xrpDirection" style="font-size:18px; font-weight:bold;">-</span>
                </div>
                <div style="display:flex; gap:6px; margin-bottom:8px;">
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:9px; color:#555;" class="open-label">ì •ì‹œ ì‹œì‘ê°€</div>
                        <div id="xrpHourOpen" style="font-size:14px; font-weight:bold; color:#888;">-</div>
                    </div>
                    <div style="flex:0 0 20px; display:flex; align-items:center; justify-content:center;">
                        <span id="xrpArrow" style="font-size:16px; color:#666;">â†’</span>
                    </div>
                    <div style="flex:1; text-align:center;">
                        <div style="font-size:9px; color:#555;">í˜„ì¬ê°€</div>
                        <div id="xrpNowPrice" style="font-size:14px; font-weight:bold; color:#fff;">-</div>
                    </div>
                </div>
                <div id="xrpPriceBar" style="height:5px; border-radius:3px; background:#1a1a1a; overflow:hidden; margin-bottom:4px;">
                    <div id="xrpPriceFill" style="height:100%; width:50%; border-radius:3px; transition:all 0.5s;"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:10px;">
                    <span id="xrpPriceDiff" style="color:#666;">-</span>
                    <span id="xrpPricePct" style="color:#666;">-</span>
                </div>
            </div>
        </div>
        <div class="ind-grid" style="margin-top:10px;">
            <div class="ind-item"><div class="ind-label">í€ë”©ë¹„</div><div class="ind-value" id="indFunding">-</div><div class="ind-sub" id="indFundingLabel">-</div></div>
            <div class="ind-item"><div class="ind-label">ê³µí¬/íƒìš•</div><div class="ind-value" id="indFG">-</div><div class="ind-sub" id="indFGLabel">-</div></div>
            <div class="ind-item"><div class="ind-label">OI ë³€í™”</div><div class="ind-value" id="indOI">-</div><div class="ind-sub" id="indLS">L/S: -</div></div>
            <div class="ind-item"><div class="ind-label">ì¶”ì„¸</div><div class="ind-value" id="indTrend">-</div><div class="ind-sub" id="indTrendSub">-</div></div>
            <div class="ind-item"><div class="ind-label">RSI</div><div class="ind-value" id="indRSI">-</div><div class="ind-sub" id="indRSILabel">-</div></div>
        </div>
    </div>

    <!-- ========== 1H íƒ­ ========== -->
    <div id="tab1hContent" class="tab-content active">

        <!-- 1H ì˜¤ì¦ˆ -->
        <div class="card">
            <h3>ğŸ² Polymarket 1H ì˜¤ì¦ˆ <span style="font-size:10px; color:#444;" id="oddsTime"></span></h3>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span style="color:#f7931a; font-weight:bold; font-size:14px;">â‚¿ BTC</span>
                        <span id="btcOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:10px; margin-bottom:10px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:8px; padding:12px; text-align:center;">
                            <div style="font-size:10px; color:#4caf50; margin-bottom:4px;">â¬† UP</div>
                            <div id="btcUpOdds" style="font-size:24px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:8px; padding:12px; text-align:center;">
                            <div style="font-size:10px; color:#f44336; margin-bottom:4px;">â¬‡ DOWN</div>
                            <div id="btcDownOdds" style="font-size:24px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:8px; border-radius:4px; overflow:hidden; background:#1a1a1a;">
                        <div id="btcUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="btcDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="btcOddsSlug" style="font-size:9px; color:#333; margin-top:6px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                    <div id="btcGapIndicator" style="margin-top:6px; padding:4px 8px; border-radius:4px; background:#0a0a0a; border:1px solid #1a1a1a; font-size:10px; color:#555; display:none;">
                        <span id="btcGapText">ê°­ ìŠ¤ìº” ì¤‘...</span>
                    </div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span style="color:#627eea; font-weight:bold; font-size:14px;">Î ETH</span>
                        <span id="ethOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:10px; margin-bottom:10px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:8px; padding:12px; text-align:center;">
                            <div style="font-size:10px; color:#4caf50; margin-bottom:4px;">â¬† UP</div>
                            <div id="ethUpOdds" style="font-size:24px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:8px; padding:12px; text-align:center;">
                            <div style="font-size:10px; color:#f44336; margin-bottom:4px;">â¬‡ DOWN</div>
                            <div id="ethDownOdds" style="font-size:24px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:8px; border-radius:4px; overflow:hidden; background:#1a1a1a;">
                        <div id="ethUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="ethDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="ethOddsSlug" style="font-size:9px; color:#333; margin-top:6px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00d4aa; font-weight:bold; font-size:13px;">â— SOL</span>
                        <span id="solOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="solUpOdds" style="font-size:20px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="solDownOdds" style="font-size:20px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="solUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="solDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00aaff; font-weight:bold; font-size:13px;">âœ• XRP</span>
                        <span id="xrpOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="xrpUpOdds" style="font-size:20px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="xrpDownOdds" style="font-size:20px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="xrpUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="xrpDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì°¨íŠ¸ -->
        <div class="card">
            <h3 style="display:flex; align-items:center; gap:10px;">
                ğŸ“ˆ 1H ì°¨íŠ¸
                <button id="chartBtcBtn" onclick="switchChart('BTC')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:#f7931a; color:#000; border:1px solid #f7931a;">â‚¿ BTC</button>
                <button id="chartEthBtn" onclick="switchChart('ETH')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#627eea; border:1px solid #333;">Î ETH</button>
                <button id="chartSolBtn" onclick="switchChart('SOL')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#00d4aa; border:1px solid #333;">â— SOL</button>
                <button id="chartXrpBtn" onclick="switchChart('XRP')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#00aaff; border:1px solid #333;">âœ• XRP</button>
            </h3>
            <div id="chartContainer" style="height:400px; background:#0a0a0a; border-radius:6px;"></div>
        </div>

        <!-- 1H íŠ¸ë¦¬ê±° -->
        <div class="card">
            <h3 style="display:flex; align-items:center; gap:8px;">
                â±ï¸ 1H íŠ¸ë¦¬ê±°
                <span style="font-size:10px; color:#444; font-weight:normal;">Auto 72H Â· ë§¤ì‹œ ìë™ë¶„ì„</span>
            </h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px;">
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px 14px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span style="color:#f7931a; font-weight:bold; font-size:13px;">â‚¿ BTC</span>
                        <span id="btcTriggerSource" style="font-size:10px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="btcTriggerInfo"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px 14px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span style="color:#627eea; font-weight:bold; font-size:13px;">Î ETH</span>
                        <span id="ethTriggerSource" style="font-size:10px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="ethTriggerInfo"></div>
                </div>
            </div>
            <div style="margin-top:10px; padding:10px 14px; background:#0d1117; border:1px solid #1a1a2e; border-radius:6px;">
                <div style="font-size:11px; color:#555; line-height:1.6;">
                    ğŸ’¡ <span style="color:#64b5f6;">EV (Expected Value)</span> = ê¸°ëŒ€ìˆ˜ìµë¥ .
                    ì˜ˆ: ì˜¤ì¦ˆ 40Â¢ì— UP ë°°íŒ… â†’ ìŠ¹ë¥  60%ë©´ EV = <span style="color:#4caf50;">+50%</span> (0.6Ã—$1/0.4 - 1).
                    <span style="color:#888;">íƒìƒ‰ íŠ¸ë¦¬ê±°ëŠ” EV ê¸°ì¤€â†‘(ì‹ ì¤‘), í™•ì¸ íŠ¸ë¦¬ê±°ëŠ” EV ê¸°ì¤€â†“(ë³´ì™„).</span>
                </div>
            </div>
        </div>

        <!-- 1H ëˆ„ì  ì„±ê³¼ -->
        <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
            <div class="card">
                <h3 style="color:#f7931a;">ğŸ“Š â‚¿ BTC 1H</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="btcStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="btcStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="btcStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card">
                <h3 style="color:#627eea;">ğŸ“Š Î ETH 1H</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="ethStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="ethStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="ethStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card">
                <h3 style="color:#00d4aa;">ğŸ“Š â— SOL 1H</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="solStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="solStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="solStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card">
                <h3 style="color:#00aaff;">ğŸ“Š âœ• XRP 1H</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="xrpStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="xrpStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="xrpStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
        </div>

        <!-- 1H ë°°íŒ… ê¸°ë¡ -->
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card">
                <h3 style="color:#f7931a;">ğŸ’¼ â‚¿ BTC 1H ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="btcTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card">
                <h3 style="color:#627eea;">ğŸ’¼ Î ETH 1H ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="ethTradeTable"></tbody></table>
                </div>
            </div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card">
                <h3 style="color:#00d4aa;">ğŸ’¼ â— SOL 1H ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="solTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card">
                <h3 style="color:#00aaff;">ğŸ’¼ âœ• XRP 1H ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="xrpTradeTable"></tbody></table>
                </div>
            </div>
        </div>

    </div><!-- /tab1hContent -->

    <!-- ========== 15M íƒ­ ========== -->
    <div id="tab15mContent" class="tab-content">

        <!-- 15M ì˜¤ì¦ˆ -->
        <div class="card" style="border-color:#2a1a2a;">
            <h3 style="color:#ce93d8;">ğŸ² Polymarket 15M ì˜¤ì¦ˆ <span style="font-size:10px; color:#444;" id="odds15mTime"></span></h3>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#f7931a; font-weight:bold; font-size:13px;">â‚¿ BTC 15M</span>
                        <span id="btc15mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="btc15mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="btc15mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="btc15mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="btc15mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="btc15mOddsSlug" style="font-size:9px; color:#333; margin-top:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#627eea; font-weight:bold; font-size:13px;">Î ETH 15M</span>
                        <span id="eth15mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="eth15mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="eth15mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="eth15mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="eth15mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="eth15mOddsSlug" style="font-size:9px; color:#333; margin-top:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00d4aa; font-weight:bold; font-size:13px;">â— SOL 15M</span>
                        <span id="sol15mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="sol15mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="sol15mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="sol15mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="sol15mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00aaff; font-weight:bold; font-size:13px;">âœ• XRP 15M</span>
                        <span id="xrp15mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="xrp15mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="xrp15mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="xrp15mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="xrp15mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 15M ì°¨íŠ¸ -->
        <div class="card" style="border-color:#2a1a2a;">
            <h3 style="display:flex; align-items:center; gap:10px; color:#ce93d8;">
                ğŸ“ˆ 15M ì°¨íŠ¸
                <button id="chart15mBtcBtn" onclick="switchChart15m('BTC')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:#f7931a; color:#000; border:1px solid #f7931a;">â‚¿ BTC</button>
                <button id="chart15mEthBtn" onclick="switchChart15m('ETH')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#627eea; border:1px solid #333;">Î ETH</button>
                <button id="chart15mSolBtn" onclick="switchChart15m('SOL')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#00d4aa; border:1px solid #333;">â— SOL</button>
                <button id="chart15mXrpBtn" onclick="switchChart15m('XRP')" style="padding:3px 10px; border-radius:4px; font-size:11px; font-weight:bold; cursor:pointer; background:transparent; color:#00aaff; border:1px solid #333;">âœ• XRP</button>
            </h3>
            <div id="chart15mContainer" style="height:400px; background:#0a0a0a; border-radius:6px;"></div>
        </div>

        <!-- 15M íŠ¸ë¦¬ê±° -->
        <div class="card" style="border-color:#2a1a2a;">
            <h3 style="display:flex; align-items:center; gap:8px; color:#ce93d8;">
                â±ï¸ 15M íŠ¸ë¦¬ê±°
                <span style="font-size:10px; color:#555; font-weight:normal;">ìœˆë„ìš° ë‚´ ì˜¤í”„ì…‹(ë¶„)</span>
            </h3>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px; margin-top:8px;">
                <div style="background:#111; border:1px solid #2a1a2a; border-radius:8px; padding:10px 12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#f7931a; font-weight:bold; font-size:12px;">â‚¿ BTC 15M</span>
                        <span id="btc15mTriggerSource" style="font-size:9px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="btc15mTriggerInfo"></div>
                </div>
                <div style="background:#111; border:1px solid #2a1a2a; border-radius:8px; padding:10px 12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#627eea; font-weight:bold; font-size:12px;">Î ETH 15M</span>
                        <span id="eth15mTriggerSource" style="font-size:9px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="eth15mTriggerInfo"></div>
                </div>
                <div style="background:#111; border:1px solid #2a1a2a; border-radius:8px; padding:10px 12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00d4aa; font-weight:bold; font-size:12px;">â— SOL 15M</span>
                        <span id="sol15mTriggerSource" style="font-size:9px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="sol15mTriggerInfo"></div>
                </div>
                <div style="background:#111; border:1px solid #2a1a2a; border-radius:8px; padding:10px 12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00aaff; font-weight:bold; font-size:12px;">âœ• XRP 15M</span>
                        <span id="xrp15mTriggerSource" style="font-size:9px; color:#555;">ê¸°ë³¸ê°’</span>
                    </div>
                    <div id="xrp15mTriggerInfo"></div>
                </div>
            </div>
        </div>

        <!-- 15M ëˆ„ì  ì„±ê³¼ -->
        <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#f7931a;">ğŸ“Š â‚¿ BTC 15M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="btc15mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="btc15mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="btc15mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#627eea;">ğŸ“Š Î ETH 15M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="eth15mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="eth15mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="eth15mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#00d4aa;">ğŸ“Š â— SOL 15M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="sol15mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="sol15mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="sol15mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#00aaff;">ğŸ“Š âœ• XRP 15M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="xrp15mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="xrp15mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="xrp15mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
        </div>

        <!-- 15M ë°°íŒ… ê¸°ë¡ -->
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#f7931a;">ğŸ’¼ â‚¿ BTC 15M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="btc15mTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#627eea;">ğŸ’¼ Î ETH 15M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="eth15mTradeTable"></tbody></table>
                </div>
            </div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#00d4aa;">ğŸ’¼ â— SOL 15M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="sol15mTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card" style="border-color:#2a1a2a;">
                <h3 style="color:#00aaff;">ğŸ’¼ âœ• XRP 15M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="xrp15mTradeTable"></tbody></table>
                </div>
            </div>
        </div>

    </div><!-- /tab15mContent -->

    <!-- ========== 5M íƒ­ ========== -->
    <div id="tab5mContent" class="tab-content">

        <!-- 5M ì˜¤ì¦ˆ -->
        <div class="card" style="border-color:#2a2a0a;">
            <h3 style="color:#ffd54f;">ğŸ² Polymarket 5M ì˜¤ì¦ˆ <span style="font-size:10px; color:#444;" id="odds5mTime"></span></h3>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#f7931a; font-weight:bold; font-size:13px;">â‚¿ BTC 5M</span>
                        <span id="btc5mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="btc5mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="btc5mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="btc5mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="btc5mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="btc5mOddsSlug" style="font-size:9px; color:#333; margin-top:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#627eea; font-weight:bold; font-size:13px;">Î ETH 5M</span>
                        <span id="eth5mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="eth5mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="eth5mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="eth5mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="eth5mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                    <div id="eth5mOddsSlug" style="font-size:9px; color:#333; margin-top:4px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"></div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00d4aa; font-weight:bold; font-size:13px;">â— SOL 5M</span>
                        <span id="sol5mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="sol5mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="sol5mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="sol5mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="sol5mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
                <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                        <span style="color:#00aaff; font-weight:bold; font-size:13px;">âœ• XRP 5M</span>
                        <span id="xrp5mOddsStatus" style="font-size:10px; color:#555;">ë¡œë”©...</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:8px;">
                        <div style="flex:1; background:#0a1a0a; border:1px solid #1a3a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#4caf50;">â¬† UP</div>
                            <div id="xrp5mUpOdds" style="font-size:18px; font-weight:bold; color:#4caf50;">-</div>
                        </div>
                        <div style="flex:1; background:#1a0a0a; border:1px solid #3a1a1a; border-radius:6px; padding:8px; text-align:center;">
                            <div style="font-size:9px; color:#f44336;">â¬‡ DOWN</div>
                            <div id="xrp5mDownOdds" style="font-size:18px; font-weight:bold; color:#f44336;">-</div>
                        </div>
                    </div>
                    <div style="display:flex; height:6px; border-radius:3px; overflow:hidden; background:#1a1a1a;">
                        <div id="xrp5mUpBar" style="background:#4caf50; width:50%; transition:width 0.5s;"></div>
                        <div id="xrp5mDownBar" style="background:#f44336; width:50%; transition:width 0.5s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5M ëˆ„ì  ì„±ê³¼ -->
        <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#f7931a;">ğŸ“Š â‚¿ BTC 5M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="btc5mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="btc5mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="btc5mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#627eea;">ğŸ“Š Î ETH 5M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="eth5mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="eth5mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="eth5mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#00d4aa;">ğŸ“Š â— SOL 5M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="sol5mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="sol5mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="sol5mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#00aaff;">ğŸ“Š âœ• XRP 5M</h3>
                <div class="stat-grid" style="grid-template-columns:repeat(3, 1fr);">
                    <div class="stat-item"><div class="stat-num" id="xrp5mStatTotal">0</div><div class="stat-label">ë°°íŒ…</div></div>
                    <div class="stat-item"><div class="stat-num" id="xrp5mStatWinRate" style="color:#4caf50;">0%</div><div class="stat-label">ìŠ¹ë¥ </div></div>
                    <div class="stat-item"><div class="stat-num" id="xrp5mStatPnl">$0</div><div class="stat-label">PNL</div></div>
                </div>
            </div>
        </div>

        <!-- 5M ë°°íŒ… ê¸°ë¡ -->
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#f7931a;">ğŸ’¼ â‚¿ BTC 5M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="btc5mTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#627eea;">ğŸ’¼ Î ETH 5M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="eth5mTradeTable"></tbody></table>
                </div>
            </div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#00d4aa;">ğŸ’¼ â— SOL 5M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="sol5mTradeTable"></tbody></table>
                </div>
            </div>
            <div class="card" style="border-color:#2a2a0a;">
                <h3 style="color:#00aaff;">ğŸ’¼ âœ• XRP 5M ë°°íŒ…</h3>
                <div style="overflow-x:auto;">
                <table><thead><tr>
                    <th>ì‹œê°„</th><th>ë°©í–¥</th><th>ì‹œì´ˆê°€</th><th>ì§„ì…ê°€</th><th>ì¢…ê°€</th><th>ê¸ˆì•¡</th><th>í™•ì‹ </th><th>EV</th><th>ê²°ê³¼</th><th>PNL</th>
                </tr></thead><tbody id="xrp5mTradeTable"></tbody></table>
                </div>
            </div>
        </div>

    </div><!-- /tab5mContent -->

    <!-- ===== ê³µí†µ: í¬íŠ¸í´ë¦¬ì˜¤ ===== -->
    <div class="card" id="portfolioCard" style="border-color:#1a3a1a;">
        <h3>ğŸ’° ë±…í¬ë¡¤ ì‹œë®¬ë ˆì´ì…˜ <span style="font-size:10px; color:#444; font-weight:normal;">$50 ì‹œì‘ Â· DRY-RUN</span></h3>
        <div style="display:grid; grid-template-columns:1fr 1.3fr 1fr 1fr 1fr; gap:12px; margin-top:8px;">
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px; text-align:center;">
                <div style="font-size:10px; color:#555; margin-bottom:4px;">ì‹œì‘ ìê¸ˆ</div>
                <div id="portInitial" style="font-size:20px; font-weight:bold; color:#888;">$50.00</div>
            </div>
            <div id="portTotalBox" style="background:#0a0a1a; border:1px solid #1a1a3a; border-radius:8px; padding:14px; text-align:center;">
                <div style="font-size:10px; color:#64b5f6; margin-bottom:4px;">ğŸ’ ì´ ìì‚° (ì”ì•¡+ë°°íŒ…)</div>
                <div id="portTotal" style="font-size:28px; font-weight:bold; color:#64b5f6;">$50.00</div>
                <div id="portTotalSub" style="font-size:10px; color:#555; margin-top:2px;">ì”ì•¡ $50 + ë°°íŒ… $0</div>
            </div>
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px; text-align:center;">
                <div style="font-size:10px; color:#555; margin-bottom:4px;">ê°€ìš© ì”ì•¡</div>
                <div id="portCurrent" style="font-size:20px; font-weight:bold; color:#4caf50;">$50.00</div>
            </div>
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px; text-align:center;">
                <div style="font-size:10px; color:#555; margin-bottom:4px;">ìˆ˜ìµë¥ </div>
                <div id="portPnlPct" style="font-size:20px; font-weight:bold; color:#888;">0.0%</div>
            </div>
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:14px; text-align:center;">
                <div style="font-size:10px; color:#555; margin-bottom:4px;">ì†ìµ</div>
                <div id="portPnlAbs" style="font-size:20px; font-weight:bold; color:#888;">$0.00</div>
            </div>
        </div>
        <div style="margin-top:12px; background:#0a0a0a; border:1px solid #1a1a1a; border-radius:8px; padding:12px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                <span style="font-size:11px; color:#555;">ğŸ“ˆ ì´í€„ë¦¬í‹° ì»¤ë¸Œ</span>
                <span id="equityCurveInfo" style="font-size:10px; color:#444;">ë°ì´í„° ëŒ€ê¸° ì¤‘...</span>
            </div>
            <canvas id="equityCanvas" width="800" height="180" style="width:100%; height:180px; border-radius:4px;"></canvas>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                <div style="font-size:10px; color:#555; margin-bottom:8px;">ğŸ¯ í™œì„± ë°°íŒ… (PENDING)</div>
                <div style="display:flex; gap:8px;">
                    <div style="flex:1; text-align:center; padding:6px; background:#1a1a1a; border-radius:6px;">
                        <div style="font-size:9px; color:#f7931a;">â‚¿ BTC</div>
                        <div id="lockedBtc" style="font-size:15px; font-weight:bold; color:#f7931a;">$0</div>
                    </div>
                    <div style="flex:1; text-align:center; padding:6px; background:#1a1a1a; border-radius:6px;">
                        <div style="font-size:9px; color:#627eea;">Î ETH</div>
                        <div id="lockedEth" style="font-size:15px; font-weight:bold; color:#627eea;">$0</div>
                    </div>
                    <div style="flex:1; text-align:center; padding:6px; background:#1a1a1a; border-radius:6px;">
                        <div style="font-size:9px; color:#00d4aa;">â— SOL</div>
                        <div id="lockedSol" style="font-size:15px; font-weight:bold; color:#00d4aa;">$0</div>
                    </div>
                    <div style="flex:1; text-align:center; padding:6px; background:#1a1a1a; border-radius:6px;">
                        <div style="font-size:9px; color:#00aaff;">âœ• XRP</div>
                        <div id="lockedXrp" style="font-size:15px; font-weight:bold; color:#00aaff;">$0</div>
                    </div>
                </div>
                <div id="pendingCount" style="font-size:10px; color:#444; text-align:center; margin-top:6px;">0ê±´ ì§„í–‰ ì¤‘</div>
            </div>
            <div style="background:#111; border:1px solid #222; border-radius:8px; padding:12px;">
                <div style="font-size:10px; color:#555; margin-bottom:8px;">ğŸ’ ìì‚° ë³€í™”</div>
                <div style="position:relative; height:24px; background:#1a1a1a; border-radius:12px; overflow:hidden; margin-bottom:6px;">
                    <div id="portBar" style="height:100%; width:50%; border-radius:12px; transition:all 0.5s; background:linear-gradient(90deg, #1b5e20, #4caf50);"></div>
                    <div style="position:absolute; left:50%; top:0; height:100%; width:2px; background:#555; z-index:1;"></div>
                    <div id="portBarLabel" style="position:absolute; right:8px; top:50%; transform:translateY(-50%); font-size:11px; font-weight:bold; color:#fff; z-index:2;">$50</div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:9px; color:#444;">
                    <span>íŒŒì‚° $0</span><span style="color:#666;">ì›ê¸ˆ $50</span><span>ëª©í‘œ $100</span>
                </div>
                <div style="margin-top:10px; padding:8px; background:#0d1117; border-radius:6px;">
                    <div style="font-size:9px; color:#555; margin-bottom:4px;">ğŸ”® 12ì‹œê°„ ì˜ˆìƒ (ì‹œê°„ë‹¹ ~2ë°°íŒ…)</div>
                    <div id="scenarioText" style="font-size:10px; color:#666; line-height:1.5;">ë°ì´í„° ìŒ“ì´ë©´ ì˜ˆì¸¡ í‘œì‹œ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ê³µí†µ: AI ëˆ„ì  í•™ìŠµ -->
    <div class="card">
        <h3 style="display:flex; align-items:center; gap:10px;">
            ğŸ§  AI ëˆ„ì  í•™ìŠµ
            <span style="font-size:10px; color:#444; font-weight:normal;">3ê³„ì¸µ: ì¡°ê±´ë¶€ ìŠ¹ë¥  + AI êµí›ˆ + ìµœê·¼ ë°˜ì„±</span>
            <button onclick="compressLessons()" style="margin-left:auto; background:#1a1a2a; color:#64b5f6; border:1px solid #2a2a4a; border-radius:4px; padding:3px 10px; font-size:10px; cursor:pointer;">ğŸ”„ êµí›ˆ ì••ì¶•</button>
        </h3>
        <div id="lessonsGrid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:8px; margin-top:8px;">
            <div style="color:#444; font-size:11px; padding:10px;">ë°ì´í„° ìŒ“ì´ëŠ” ì¤‘...</div>
        </div>
        <div id="lessonsFooter" style="font-size:10px; color:#444; margin-top:8px; padding:6px 10px; background:#0d1117; border-radius:4px;">
            ğŸ’¡ ë°˜ì„± 5ê±´ ëˆ„ì  ì‹œ ìë™ ì••ì¶• Â· êµí›ˆì€ ë§¤ íŒë‹¨ì— ìë™ ë°˜ì˜
        </div>
    </div>

    <div style="text-align:right; margin-top:4px;">
        <button onclick="deleteAllTrades()" style="background:#3a1a1a; color:#f44336; border:1px solid #f44336; border-radius:4px; padding:4px 12px; font-size:10px; cursor:pointer;">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
    </div>

</div>

<!-- ì‹¤ì‹œê°„ ë¡œê·¸ ì‚¬ì´ë“œë°” -->
<div class="sidebar">
    <div class="log-header">
        <h3>ğŸ“‹ ì‹¤ì‹œê°„ ë¡œê·¸</h3>
        <p style="font-size:11px; color:#555; margin-top:2px;">WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</p>
    </div>
    <div id="logBox"></div>
    <div class="log-count" id="logCount">0ê°œ ë¡œê·¸</div>
</div>
</div>

<script src="https://s3.tradingview.com/tv.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
<script>
    let currentCoin = 'BTC';
    let currentCoin15m = 'BTC';
    let currentTimeframe = '1H';
    let indicatorCache = { BTC: null, ETH: null, SOL: null, XRP: null };
    let tvWidget = null;
    let tvWidget15m = null;

    // ===== íƒ€ì„í”„ë ˆì„ íƒ­ ì „í™˜ =====
    function switchTimeframe(tf) {
        currentTimeframe = tf;
        const tabs = {
            '1H':  { tab: 'tfTab1h',  content: 'tab1hContent',  btns: 'headerBtns1h',  cls: 'active-1h' },
            '15M': { tab: 'tfTab15m', content: 'tab15mContent', btns: 'headerBtns15m', cls: 'active-15m' },
            '5M':  { tab: 'tfTab5m',  content: 'tab5mContent',  btns: 'headerBtns5m',  cls: 'active-5m' }
        };
        for (const [key, v] of Object.entries(tabs)) {
            const isActive = key === tf;
            document.getElementById(v.tab).className = isActive ? 'tf-tab ' + v.cls : 'tf-tab';
            const content = document.getElementById(v.content);
            if (content) { isActive ? content.classList.add('active') : content.classList.remove('active'); }
            const btns = document.getElementById(v.btns);
            if (btns) { btns.style.display = isActive ? '' : 'none'; }
        }
        // íƒ­ ì „í™˜ì‹œ ì¦‰ì‹œ ì‹œì´ˆê°€ ë°˜ì˜
        tickPrice();
    }

    // ===== TradingView ì°¨íŠ¸ =====
    function initChart(symbol) {
        if (tvWidget) tvWidget.remove();
        tvWidget = new TradingView.widget({
            "autosize": true, "symbol": "BINANCE:" + symbol, "interval": "60",
            "timezone": "Asia/Seoul", "theme": "dark", "style": "1", "locale": "kr",
            "enable_publishing": false, "allow_symbol_change": false,
            "container_id": "chartContainer", "hide_top_toolbar": false, "hide_side_toolbar": false,
            "backgroundColor": "#0a0a0a", "gridColor": "#1a1a1a",
            "studies": ["RSI@tv-basicstudies","MACD@tv-basicstudies"],
            "disabled_features": ["use_localstorage_for_settings"]
        });
    }

    // ===== WebSocket =====
    let stompClient;
    function connectWs() {
        try {
            const socket = new SockJS('/ws');
            stompClient = Stomp.over(socket);
            stompClient.debug = null;
            stompClient.connect({}, function() {
                stompClient.subscribe('/topic/trading', function(msg) { addLog(msg.body); });
            }, function() { setTimeout(connectWs, 3000); });
        } catch(e) { setTimeout(connectWs, 3000); }
    }
    connectWs();

    let logCount = 0;
    function addLog(msg) {
        const box = document.getElementById('logBox');
        const line = document.createElement('div');
        line.className = 'log-line';
        const now = new Date().toLocaleTimeString('ko-KR');
        line.textContent = `[${now}] ${msg}`;
        if (msg.includes('âŒ')||msg.includes('ì˜¤ë¥˜')||msg.includes('LOSE')) line.style.color='#f44336';
        else if (msg.includes('âœ…')||msg.includes('WIN')||msg.includes('UP')) line.style.color='#4caf50';
        else if (msg.includes('ğŸ§ ')||msg.includes('Claude')) line.style.color='#64b5f6';
        else if (msg.includes('ğŸŸ¡')||msg.includes('DRY')||msg.includes('HOLD')) line.style.color='#ff9800';
        else line.style.color='#bbb';
        box.insertBefore(line, box.firstChild);
        logCount++;
        document.getElementById('logCount').textContent = logCount + 'ê°œ ë¡œê·¸';
        if (box.children.length > 200) box.removeChild(box.lastChild);
    }

    // ===== ì°¨íŠ¸ BTC/ETH ì „í™˜ =====
    const coinColors = { BTC: '#f7931a', ETH: '#627eea', SOL: '#00d4aa', XRP: '#00aaff' };
    function switchChart(coin) {
        currentCoin = coin;
        ['BTC','ETH','SOL','XRP'].forEach(c => {
            const btn = document.getElementById('chart' + c.charAt(0) + c.slice(1).toLowerCase() + 'Btn');
            if (!btn) return;
            if (c === coin) {
                btn.style.background = coinColors[c]; btn.style.color = c==='BTC'?'#000':'#fff'; btn.style.borderColor = coinColors[c];
            } else {
                btn.style.background = 'transparent'; btn.style.color = coinColors[c]; btn.style.borderColor = '#333';
            }
        });
        initChart(coin + 'USDT');
        updateIndicatorUI();
    }

    // ===== 15M ì°¨íŠ¸ 4ì½”ì¸ ì „í™˜ =====
    function switchChart15m(coin) {
        currentCoin15m = coin;
        ['BTC','ETH','SOL','XRP'].forEach(c => {
            const btn = document.getElementById('chart15m' + c.charAt(0) + c.slice(1).toLowerCase() + 'Btn');
            if (!btn) return;
            if (c === coin) {
                btn.style.background = coinColors[c]; btn.style.color = c==='BTC'?'#000':'#fff'; btn.style.borderColor = coinColors[c];
            } else {
                btn.style.background = 'transparent'; btn.style.color = coinColors[c]; btn.style.borderColor = '#333';
            }
        });
        initChart15m(coin + 'USDT');
    }

    function initChart15m(symbol) {
        if (tvWidget15m) tvWidget15m.remove();
        tvWidget15m = new TradingView.widget({
            "autosize": true, "symbol": "BINANCE:" + symbol, "interval": "15",
            "timezone": "Asia/Seoul", "theme": "dark", "style": "1", "locale": "kr",
            "enable_publishing": false, "allow_symbol_change": false,
            "container_id": "chart15mContainer", "hide_top_toolbar": false, "hide_side_toolbar": false,
            "backgroundColor": "#0a0a0a", "gridColor": "#1a1a1a",
            "studies": ["RSI@tv-basicstudies","MACD@tv-basicstudies"],
            "disabled_features": ["use_localstorage_for_settings"]
        });
    }

    // ===== ê°€ê²© ê°±ì‹  =====
    let hourOpen = { BTC: 0, ETH: 0, SOL: 0, XRP: 0 };
    let open15m = { BTC: 0, ETH: 0, SOL: 0, XRP: 0 };

    async function tickPrice() {
        const dot = document.getElementById('tickDot');
        dot.style.color = '#4caf50';
        setTimeout(() => dot.style.color = '#333', 200);
        try {
            const [btcRes, ethRes, solRes, xrpRes] = await Promise.all([
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT').then(r=>r.json()),
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT').then(r=>r.json()),
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=SOLUSDT').then(r=>r.json()),
                fetch('https://api.binance.com/api/v3/ticker/price?symbol=XRPUSDT').then(r=>r.json())
            ]);
            const useOpen = currentTimeframe === '15M' ? open15m : hourOpen;
            updatePriceCard('btc', parseFloat(btcRes.price), useOpen.BTC);
            updatePriceCard('eth', parseFloat(ethRes.price), useOpen.ETH);
            updatePriceCard('sol', parseFloat(solRes.price), useOpen.SOL);
            updatePriceCard('xrp', parseFloat(xrpRes.price), useOpen.XRP);
            const openLabel = currentTimeframe === '15M' ? '15M ì‹œì‘ê°€' : 'ì •ì‹œ ì‹œì‘ê°€';
            document.querySelectorAll('.open-label').forEach(el => el.textContent = openLabel);
            document.getElementById('tickTime').textContent = new Date().toLocaleTimeString('ko-KR');
        } catch(e) {}
    }

    function updatePriceCard(prefix, price, open) {
        const fmt = {minimumFractionDigits:2, maximumFractionDigits:2};
        document.getElementById(prefix+'NowPrice').textContent = '$' + price.toLocaleString('en-US', fmt);
        if (open > 0) {
            document.getElementById(prefix+'HourOpen').textContent = '$' + open.toLocaleString('en-US', fmt);
            const diff = price - open;
            const pct = (diff / open) * 100;
            const isUp = diff >= 0;
            const dirEl = document.getElementById(prefix+'Direction');
            dirEl.textContent = isUp ? 'â¬† UP' : 'â¬‡ DOWN';
            dirEl.style.color = isUp ? '#4caf50' : '#f44336';
            document.getElementById(prefix+'Arrow').textContent = isUp ? 'â†—' : 'â†˜';
            document.getElementById(prefix+'Arrow').style.color = isUp ? '#4caf50' : '#f44336';
            document.getElementById(prefix+'PriceDiff').textContent = (isUp?'+':'') + diff.toFixed(2);
            document.getElementById(prefix+'PriceDiff').style.color = isUp ? '#4caf50' : '#f44336';
            document.getElementById(prefix+'PricePct').textContent = (isUp?'+':'') + pct.toFixed(3) + '%';
            document.getElementById(prefix+'PricePct').style.color = isUp ? '#4caf50' : '#f44336';
            const fillEl = document.getElementById(prefix+'PriceFill');
            const barPct = Math.min(Math.abs(pct) * 20, 100);
            fillEl.style.width = (50 + (isUp ? barPct/2 : -barPct/2)) + '%';
            fillEl.style.background = isUp ? '#4caf50' : '#f44336';
            document.getElementById(prefix+'PriceCard').style.borderColor = isUp ? '#1a3a1a' : '#3a1a1a';
        }
    }

    // ===== ì§€í‘œ =====
    async function refreshAllIndicators() {
        for (const coin of ['BTC', 'ETH', 'SOL', 'XRP']) {
            try {
                const m = await fetch('/indicators?coin=' + coin).then(r => r.json());
                indicatorCache[coin] = m;
                // BTC/ETHëŠ” ë ˆê±°ì‹œ í•„ë“œ, SOL/XRPëŠ” coin* ë²”ìš© í•„ë“œ
                if (coin === 'BTC') {
                    if (m.btcHourOpen > 0) hourOpen.BTC = m.btcHourOpen;
                    if (m.btc15mOpen > 0) open15m.BTC = m.btc15mOpen;
                } else if (coin === 'ETH') {
                    if (m.ethHourOpen > 0) hourOpen.ETH = m.ethHourOpen;
                    if (m.eth15mOpen > 0) open15m.ETH = m.eth15mOpen;
                } else {
                    if (m.coinHourOpen > 0) hourOpen[coin] = m.coinHourOpen;
                    if (m.coin15mOpen > 0) open15m[coin] = m.coin15mOpen;
                }
            } catch(e) {}
        }
        updateIndicatorUI();
    }

    function updateIndicatorUI() {
        const m = indicatorCache[currentCoin];
        if (!m) return;
        const fr = m.fundingRate || 0;
        document.getElementById('indFunding').textContent = (fr>=0?'+':'') + fr.toFixed(4) + '%';
        document.getElementById('indFunding').className = 'ind-value ' + (fr > 0.05 ? 'down' : fr < -0.05 ? 'up' : 'neutral');
        document.getElementById('indFundingLabel').textContent = fr > 0.05 ? 'ë¡± ê³¼ì—´' : fr < -0.05 ? 'ìˆ ê³¼ì—´' : 'ì¤‘ë¦½';
        const fg = m.fearGreedIndex || 50;
        document.getElementById('indFG').textContent = fg;
        document.getElementById('indFG').className = 'ind-value ' + (fg<=30?'up':fg>=70?'down':'neutral');
        document.getElementById('indFGLabel').textContent = m.fearGreedLabel || '-';
        const oi = m.openInterestChange || 0;
        document.getElementById('indOI').textContent = (oi>=0?'+':'') + oi.toFixed(2) + '%';
        document.getElementById('indOI').className = 'ind-value ' + (oi>=0?'up':'down');
        document.getElementById('indLS').textContent = 'L/S: ' + (m.longShortRatio||'-');
        const trend = m.trend || 'SIDEWAYS';
        document.getElementById('indTrend').textContent = trend === 'UPTREND' ? 'ğŸ“ˆ UP' : trend === 'DOWNTREND' ? 'ğŸ“‰ DOWN' : 'â¡ï¸ íš¡ë³´';
        document.getElementById('indTrend').className = 'ind-value ' + (trend==='UPTREND'?'up':trend==='DOWNTREND'?'down':'neutral');
        document.getElementById('indTrendSub').textContent = currentCoin + ' ì¢…í•©';
        const rsi = m.rsi || 50;
        document.getElementById('indRSI').textContent = rsi.toFixed(1);
        document.getElementById('indRSI').className = 'ind-value ' + (rsi>=70?'down':rsi<=30?'up':'neutral');
        document.getElementById('indRSILabel').textContent = rsi>=70?'ê³¼ë§¤ìˆ˜':rsi<=30?'ê³¼ë§¤ë„':'ì¤‘ë¦½';
    }

    // ===== í†µê³„ =====
    async function refreshStats(coin, timeframe, prefix) {
        const p = prefix || coin.toLowerCase();
        const tfParam = timeframe ? '&timeframe=' + timeframe : '';
        try {
            const s = await fetch('/stats?coin=' + coin + tfParam).then(r => r.json());
            document.getElementById(p + 'StatTotal').textContent = s.total||0;
            document.getElementById(p + 'StatWinRate').textContent = (s.winRate||'0')+'%';
            const pnl = parseFloat(s.pnl||0);
            const pnlEl = document.getElementById(p + 'StatPnl');
            pnlEl.textContent = (pnl>=0?'+$':'-$') + Math.abs(pnl).toFixed(2);
            pnlEl.style.color = pnl >= 0 ? '#4caf50' : '#f44336';
            document.getElementById(p + 'StatWins').textContent = s.wins||0;
            document.getElementById(p + 'StatResolved').textContent = s.resolved||0;
        } catch(e) {}
    }

    async function refreshAllStats() {
        await refreshStats('BTC', '1H', 'btc');
        await refreshStats('ETH', '1H', 'eth');
        await refreshStats('SOL', '1H', 'sol');
        await refreshStats('XRP', '1H', 'xrp');
        await refreshStats('BTC', '15M', 'btc15m');
        await refreshStats('ETH', '15M', 'eth15m');
        await refreshStats('SOL', '15M', 'sol15m');
        await refreshStats('XRP', '15M', 'xrp15m');
        await refreshStats('BTC', '5M', 'btc5m');
        await refreshStats('ETH', '5M', 'eth5m');
        await refreshStats('SOL', '5M', 'sol5m');
        await refreshStats('XRP', '5M', 'xrp5m');
        // íƒ­ ì¹´ìš´íŠ¸
        try {
            const h1 = ['btc','eth','sol','xrp'].reduce((s,p) => s + (parseInt(document.getElementById(p+'StatTotal')?.textContent)||0), 0);
            const m15 = ['btc15m','eth15m','sol15m','xrp15m'].reduce((s,p) => s + (parseInt(document.getElementById(p+'StatTotal')?.textContent)||0), 0);
            const m5 = ['btc5m','eth5m','sol5m','xrp5m'].reduce((s,p) => s + (parseInt(document.getElementById(p+'StatTotal')?.textContent)||0), 0);
            document.getElementById('tab1hCount').textContent = h1 > 0 ? ` (${h1})` : '';
            document.getElementById('tab15mCount').textContent = m15 > 0 ? ` (${m15})` : '';
            document.getElementById('tab5mCount').textContent = m5 > 0 ? ` (${m5})` : '';
        } catch(e) {}
    }

    // ===== ë°°íŒ… ê¸°ë¡ =====
    function renderTradeRow(t) {
        const isHold = t.action === 'HOLD';
        const dir = t.action==='BUY_YES' ? '<span class="tag tag-up">UP â¬†</span>'
            : t.action==='BUY_NO' ? '<span class="tag tag-down">DOWN â¬‡</span>'
            : '<span class="tag tag-hold">HOLD â¸</span>';
        const res = t.result==='WIN' ? '<span class="tag tag-win">WIN âœ…</span>'
            : t.result==='LOSE' ? '<span class="tag tag-lose">LOSE âŒ</span>'
            : t.result==='HOLD' ? '<span class="tag tag-hold">HOLD</span>'
            : '<span class="tag tag-pending">PENDING â³</span>';
        const dt = new Date(t.createdAt).toLocaleString('ko-KR',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'});
        const reason = t.reason || '';
        const evMatch = reason.match(/EV: ([+-][\d.]+%)/);
        const ev = evMatch ? evMatch[1] : '-';
        const priceFmt = {minimumFractionDigits:2, maximumFractionDigits:2};
        // ì‹œì´ˆê°€
        const open = t.openPrice ? '$' + t.openPrice.toLocaleString('en-US', priceFmt) : '<span style="color:#444;">-</span>';
        // ì§„ì…ê°€
        const entry = t.entryPrice ? '$' + t.entryPrice.toLocaleString('en-US', priceFmt) : '-';
        // ì¢…ê°€ (exit)
        let exitCell = '<span style="color:#666;">-</span>';
        if (t.exitPrice) {
            const exitFmt = '$' + t.exitPrice.toLocaleString('en-US', priceFmt);
            const diff = t.exitPrice - (t.openPrice || t.entryPrice || 0);
            const diffColor = diff >= 0 ? '#4caf50' : '#f44336';
            const diffSign = diff >= 0 ? 'â–²' : 'â–¼';
            exitCell = `<span style="color:${diffColor};">${exitFmt} ${diffSign}</span>`;
        } else if (t.result === 'PENDING') {
            const created = new Date(t.createdAt);
            const candleClose = new Date(created);
            const tf = t.timeframe || '1H';
            if (tf === '15M') {
                const minute = created.getMinutes();
                const windowStart = Math.floor(minute / 15) * 15;
                candleClose.setMinutes(windowStart + 15, 0, 0);
            } else {
                candleClose.setMinutes(0, 0, 0);
                candleClose.setHours(candleClose.getHours() + 1);
            }
            const now = new Date();
            if (now < candleClose) {
                const remainMin = Math.ceil((candleClose - now) / 60000);
                const label = tf === '15M' ? 'ë§ˆê°' : 'ì •ì‹œ';
                exitCell = `<span style="color:#ff9800; font-size:9px;">${label} ${remainMin}ë¶„ ì „</span>`;
            } else {
                exitCell = '<span style="color:#ff9800; font-size:9px;">íŒì • ì¤‘...</span>';
            }
        }
        const tradeId = t.id || 0;
        const hasReason = reason && reason.length > 5;
        const expandIcon = hasReason ? '<span style="font-size:9px; color:#444; margin-left:2px;">ğŸ’¬</span>' : '';
        const rowStyle = isHold ? ' style="opacity:0.5;"' : '';
        return `<tr class="trade-row" data-trade-id="${tradeId}" onclick="toggleTradeDetail(this, ${tradeId})"${rowStyle}><td>${dt}${expandIcon}</td><td>${dir}</td><td style="color:#888; font-size:10px;">${open}</td><td>${entry}</td><td>${isHold ? '<span style="color:#555;">-</span>' : exitCell}</td><td>${isHold ? '-' : '$'+(t.betAmount||0).toFixed(2)}</td><td>${t.confidence||0}%</td><td style="color:#64b5f6">${ev}</td><td>${res}</td><td style="color:${(t.profitLoss||0)>=0?'#4caf50':'#f44336'}">${isHold ? '-' : (t.profitLoss!=null?(t.profitLoss>=0?'+$':'-$')+Math.abs(t.profitLoss).toFixed(2):'-')}</td></tr>`;
    }

    // ===== ë°°íŒ… ìƒì„¸ íŒ¨ë„ (í´ë¦­ í¼ì¹¨) =====
    let openDetailId = null;
    async function toggleTradeDetail(rowEl, tradeId) {
        // ì´ë¯¸ ì—´ë¦° ìƒì„¸ ë‹«ê¸°
        const existing = rowEl.nextElementSibling;
        if (existing && existing.classList.contains('trade-detail-row')) {
            existing.remove();
            rowEl.classList.remove('expanded');
            openDetailId = null;
            return;
        }
        // ë‹¤ë¥¸ ì—´ë¦° ìƒì„¸ ëª¨ë‘ ë‹«ê¸°
        document.querySelectorAll('tr.trade-detail-row').forEach(r => {
            r.previousElementSibling?.classList.remove('expanded');
            r.remove();
        });
        if (tradeId === 0) return;
        rowEl.classList.add('expanded');
        openDetailId = tradeId;

        // ë¡œë”© í–‰ ì‚½ì…
        const colCount = rowEl.children.length;
        const loadingRow = document.createElement('tr');
        loadingRow.className = 'trade-detail-row';
        loadingRow.innerHTML = `<td colspan="${colCount}"><div class="trade-detail" style="text-align:center; color:#555; padding:20px;">â³ ë¶„ì„ ë¡œë”© ì¤‘...</div></td>`;
        rowEl.after(loadingRow);

        try {
            const data = await fetch('/trade/' + tradeId + '/analysis').then(r => r.json());
            if (openDetailId !== tradeId) return; // ì‚¬ìš©ìê°€ ì´ë¯¸ ë‹«ì•˜ìœ¼ë©´ ë¬´ì‹œ

            let html = '<div class="trade-detail">';

            // ë©”íƒ€ ì¹©ë“¤
            html += '<div class="detail-meta" style="margin-bottom:10px;">';
            if (data.coin) html += `<span class="detail-chip" style="color:${data.coin==='BTC'?'#f7931a':'#627eea'};">${data.coin} ${data.timeframe||'1H'}</span>`;
            if (data.confidence) html += `<span class="detail-chip">í™•ì‹ ë„ ${data.confidence}%</span>`;
            if (data.fundingRate != null) html += `<span class="detail-chip">í€ë”© ${data.fundingRate >= 0 ? '+' : ''}${data.fundingRate.toFixed(4)}%</span>`;
            if (data.fearGreedIndex) html += `<span class="detail-chip">ê³µí¬íƒìš• ${data.fearGreedIndex}</span>`;
            if (data.buyOdds && data.buyOdds > 0) html += `<span class="detail-chip" style="background:#e040fb22;color:#e040fb">ë§¤ìˆ˜ì˜¤ì¦ˆ ${(data.buyOdds*100).toFixed(1)}Â¢</span>`;
            if (data.marketTrend) html += `<span class="detail-chip">${data.marketTrend}</span>`;
            if (data.openInterestChange != null) html += `<span class="detail-chip">OI ${data.openInterestChange >= 0 ? '+' : ''}${data.openInterestChange.toFixed(2)}%</span>`;
            if (data.buyOdds && data.buyOdds > 0) html += `<span class="detail-chip" style="background:#1a237e">ë§¤ìˆ˜ ${(data.buyOdds*100).toFixed(1)}Â¢</span>`;
            if (data.buyOdds && data.buyOdds > 0) html += `<span class="detail-chip" style="background:#e040fb22;color:#e040fb">ë§¤ìˆ˜ì˜¤ì¦ˆ ${(data.buyOdds*100).toFixed(1)}Â¢</span>`;
            html += '</div>';

            // Claude íŒë‹¨ ì´ìœ 
            if (data.reason) {
                html += '<div class="detail-section">';
                html += '<div class="detail-label">ğŸ§  Claude íŒë‹¨</div>';
                html += `<div class="detail-reason">${escapeHtml(data.reason)}</div>`;
                html += '</div>';
            }

            // Claude ì›ë³¸ ë¶„ì„ (ì ‘ê¸°/í¼ì¹˜ê¸°)
            if (data.claudeAnalysis) {
                html += '<div class="detail-section">';
                html += `<div class="detail-label" style="cursor:pointer; color:#64b5f6;" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='none'?'block':'none'">ğŸ“‹ Claude ì›ë³¸ ì‘ë‹µ â–¸ í´ë¦­í•˜ì—¬ í¼ì¹˜ê¸°</div>`;
                html += `<div class="detail-reason" style="display:none; margin-top:6px; padding:10px; background:#111; border-radius:4px; border:1px solid #222; font-size:11px; color:#999; max-height:300px; overflow-y:auto;">${escapeHtml(data.claudeAnalysis)}</div>`;
                html += '</div>';
            }

            // ë°˜ì„± ê¸°ë¡
            if (data.reflection) {
                html += '<div class="detail-section">';
                html += '<div class="detail-label">ğŸª AI ë°˜ì„±</div>';
                html += `<div class="detail-reflection">${escapeHtml(data.reflection)}</div>`;
                html += '</div>';
            }

            // ë°ì´í„° ì—†ëŠ” ê²½ìš°
            if (!data.reason && !data.claudeAnalysis && !data.reflection) {
                html += '<div style="color:#444; font-size:11px; text-align:center; padding:10px;">ë¶„ì„ ë°ì´í„° ì—†ìŒ</div>';
            }

            html += '</div>';
            loadingRow.innerHTML = `<td colspan="${colCount}">${html}</td>`;
        } catch(e) {
            loadingRow.innerHTML = `<td colspan="${colCount}"><div class="trade-detail" style="color:#f44336; text-align:center;">âš ï¸ ë¡œë”© ì‹¤íŒ¨</div></td>`;
        }
    }

    function escapeHtml(str) {
        if (!str) return '';
        return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
    }

    async function refreshTrades(coin, timeframe, tableId) {
        const tid = tableId || coin.toLowerCase() + 'TradeTable';
        const tfParam = timeframe ? '&timeframe=' + timeframe : '';
        try {
            const tbody = document.getElementById(tid);
            // ì´ í…Œì´ë¸”ì— ì—´ë¦° ìƒì„¸ íŒ¨ë„ì´ ìˆìœ¼ë©´ ìƒˆë¡œê³ ì¹¨ ìŠ¤í‚µ
            if (tbody.querySelector('tr.trade-detail-row')) return;

            const trades = await fetch('/trades?coin=' + coin + tfParam).then(r => r.json());
            tbody.innerHTML = trades.map(renderTradeRow).join('');
        } catch(e) {}
    }

    async function refreshAllTrades() {
        await refreshTrades('BTC', '1H', 'btcTradeTable');
        await refreshTrades('ETH', '1H', 'ethTradeTable');
        await refreshTrades('SOL', '1H', 'solTradeTable');
        await refreshTrades('XRP', '1H', 'xrpTradeTable');
        await refreshTrades('BTC', '15M', 'btc15mTradeTable');
        await refreshTrades('ETH', '15M', 'eth15mTradeTable');
        await refreshTrades('SOL', '15M', 'sol15mTradeTable');
        await refreshTrades('XRP', '15M', 'xrp15mTradeTable');
        await refreshTrades('BTC', '5M', 'btc5mTradeTable');
        await refreshTrades('ETH', '5M', 'eth5mTradeTable');
        await refreshTrades('SOL', '5M', 'sol5mTradeTable');
        await refreshTrades('XRP', '5M', 'xrp5mTradeTable');
    }

    // ===== ë²„íŠ¼ =====
    async function runOnce(coin, timeframe) {
        addLog(`âš¡ ${coin} ${timeframe} 1íšŒ ì‹¤í–‰ ìš”ì²­...`);
        await fetch('/trade/run?coin=' + coin + '&timeframe=' + timeframe, {method:'POST'});
    }

    async function deleteAllTrades() {
        if (!confirm('ë°°íŒ… ê¸°ë¡ì„ ì „ë¶€ ì‚­ì œí• ê¹Œìš”?')) return;
        const res = await fetch('/trades/all', {method:'DELETE'});
        const data = await res.json();
        addLog(`ğŸ—‘ï¸ ${data.count}ê±´ ì‚­ì œ ì™„ë£Œ`);
        refreshAllStats();
        refreshAllTrades();
    }

    // ===== 1H íŠ¸ë¦¬ê±° =====
    function renderTriggers(coin, config) {
        const isBtc = coin === 'BTC';
        const color = isBtc ? '#f7931a' : '#627eea';
        const infoId = isBtc ? 'btcTriggerInfo' : 'ethTriggerInfo';
        const sourceId = isBtc ? 'btcTriggerSource' : 'ethTriggerSource';
        const hasPending = config.pending != null;
        const src = config.source || 'ê¸°ë³¸ê°’';
        const isAnalyzed = src.includes('ë¶„ì„');
        let updatedLabel = '';
        if (config.updatedAt) {
            const d = new Date(config.updatedAt);
            const now = new Date();
            const diffMin = Math.floor((now - d) / 60000);
            let ago = diffMin < 1 ? 'ë°©ê¸ˆ' : diffMin < 60 ? diffMin + 'ë¶„ ì „' : diffMin < 1440 ? Math.floor(diffMin / 60) + 'ì‹œê°„ ì „' : Math.floor(diffMin / 1440) + 'ì¼ ì „';
            const timeStr = d.toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit'});
            updatedLabel = `<span style="font-size:9px; color:#444; margin-left:4px;">ğŸ• ${timeStr} (${ago})</span>`;
        }
        document.getElementById(sourceId).innerHTML = hasPending
            ? `<span style="color:${color};">â³ ëŒ€ê¸°</span> â†’ ì •ê° ì ìš©`
            : `<span style="color:${isAnalyzed ? '#4caf50' : '#555'};">${src}</span>${updatedLabel}`;
        const triggers = config.triggers || [];
        const labels = ['ğŸ” íƒìƒ‰', 'âœ… í™•ì¸'];
        const nowMin = new Date().getMinutes();
        let html = `<div style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">`;
        html += triggers.map((t, i) => {
            const acc = t.accuracy ? (t.accuracy * 100).toFixed(0) : null;
            const ev = (t.evThreshold * 100).toFixed(0);
            const isNow = t.minute === nowMin;
            const isPast = t.minute < nowMin;
            const border = isNow ? color : isPast ? '#333' : color + '50';
            const opacity = isPast ? '0.35' : '1';
            const glow = isNow ? `box-shadow:0 0 12px ${color}50;` : '';
            return `<div style="padding:10px 8px; border-radius:6px; background:#1a1a1a; border:1px solid ${border}; opacity:${opacity}; text-align:center; ${glow}">
                <div style="font-size:10px; color:#888; margin-bottom:2px;">${labels[i]}</div>
                <div style="font-size:24px; font-weight:bold; color:${color}; line-height:1.3;">${String(t.minute).padStart(2,'0')+'ë¶„'}</div>
                <div style="font-size:10px; color:#666; margin-top:3px;">EV &gt; ${ev}%${acc ? ' Â· '+acc+'%' : ''}</div>
            </div>`;
        }).join('');
        html += `</div>`;
        if (hasPending) {
            html += `<div style="margin-top:6px; font-size:10px; color:#555; display:flex; gap:6px; align-items:center;">
                â³ ${config.pending.map((t, i) => `<span style="padding:2px 6px; border:1px dashed #444; border-radius:3px; color:#666;">${labels[i]} :${String(t.minute).padStart(2,'0')}</span>`).join('')}
            </div>`;
        }
        document.getElementById(infoId).innerHTML = html;
    }

    // ===== 15M íŠ¸ë¦¬ê±° =====
    function renderTriggers15m(coin, config) {
        const isBtc = coin.startsWith('BTC');
        const color = isBtc ? '#f7931a' : '#627eea';
        const prefix = isBtc ? 'btc15m' : 'eth15m';
        const infoId = prefix + 'TriggerInfo';
        const sourceId = prefix + 'TriggerSource';
        const src = config.source || 'ê¸°ë³¸ê°’';
        const isAnalyzed = src.includes('ë¶„ì„');
        let updatedLabel = '';
        if (config.updatedAt) {
            const d = new Date(config.updatedAt);
            const now = new Date();
            const diffMin = Math.floor((now - d) / 60000);
            let ago = diffMin < 1 ? 'ë°©ê¸ˆ' : diffMin < 60 ? diffMin + 'ë¶„ ì „' : Math.floor(diffMin / 60) + 'ì‹œê°„ ì „';
            const timeStr = d.toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit'});
            updatedLabel = `<span style="font-size:9px; color:#444; margin-left:4px;">ğŸ• ${timeStr} (${ago})</span>`;
        }
        document.getElementById(sourceId).innerHTML =
            `<span style="color:${isAnalyzed ? '#4caf50' : '#555'};">${src}</span>${updatedLabel}`;
        const triggers = config.triggers || [];
        const labels = ['ğŸ” íƒìƒ‰', 'âœ… í™•ì¸'];
        const nowMin = new Date().getMinutes();
        const windowOffset = nowMin % 15;
        let html = `<div style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">`;
        html += triggers.map((t, i) => {
            const ev = (t.evThreshold * 100).toFixed(0);
            const isNow = t.minute === windowOffset;
            const isPast = t.minute < windowOffset;
            const border = isNow ? color : isPast ? '#333' : color + '50';
            const opacity = isPast ? '0.35' : '1';
            const glow = isNow ? `box-shadow:0 0 12px ${color}50;` : '';
            return `<div style="padding:10px 8px; border-radius:6px; background:#1a1a1a; border:1px solid ${border}; opacity:${opacity}; text-align:center; ${glow}">
                <div style="font-size:10px; color:#888; margin-bottom:2px;">${labels[i]}</div>
                <div style="font-size:24px; font-weight:bold; color:${color}; line-height:1.3;">${t.minute}ë¶„</div>
                <div style="font-size:10px; color:#666; margin-top:3px;">EV &gt; ${ev}%</div>
            </div>`;
        }).join('');
        html += `</div>`;
        document.getElementById(infoId).innerHTML = html;
    }

    async function loadTriggers() {
        try {
            const res = await fetch('/trigger-config/all');
            const data = await res.json();
            if (data.BTC) renderTriggers('BTC', data.BTC);
            if (data.ETH) renderTriggers('ETH', data.ETH);
            if (data.BTC_15M) renderTriggers15m('BTC_15M', data.BTC_15M);
            if (data.ETH_15M) renderTriggers15m('ETH_15M', data.ETH_15M);
        } catch(e) {}
    }

    // ===== ì”ì•¡ =====
    async function refreshBalance() {
        try {
            const d = await fetch('/balance').then(r => r.json());
            const bal = d.balance, ini = d.initial, pnl = d.profitLoss, pct = d.profitPct;
            const isUp = pnl >= 0;
            const lBtc = d.lockedBtc || 0, lEth = d.lockedEth || 0;
            const totalLocked = lBtc + lEth;
            const totalAsset = bal + totalLocked;
            const totalIsUp = totalAsset >= ini;
            const hdr = document.getElementById('balanceDisplay');
            hdr.textContent = 'ğŸ’ $' + totalAsset.toFixed(2);
            hdr.style.color = totalIsUp ? '#64b5f6' : '#f44336';
            hdr.style.background = totalIsUp ? '#0a0a1a' : '#1a0a0a';
            hdr.style.borderColor = totalIsUp ? '#1a1a3a' : '#3a1a1a';
            document.getElementById('portInitial').textContent = '$' + ini.toFixed(2);
            const curEl = document.getElementById('portCurrent');
            curEl.textContent = '$' + bal.toFixed(2);
            curEl.style.color = isUp ? '#4caf50' : '#f44336';
            const pctEl = document.getElementById('portPnlPct');
            pctEl.textContent = (isUp ? '+' : '') + pct.toFixed(1) + '%';
            pctEl.style.color = isUp ? '#4caf50' : '#f44336';
            const absEl = document.getElementById('portPnlAbs');
            absEl.textContent = (isUp ? '+$' : '-$') + Math.abs(pnl).toFixed(2);
            absEl.style.color = isUp ? '#4caf50' : '#f44336';
            const barPct = Math.max(0, Math.min(100, (bal / ini) * 50));
            const bar = document.getElementById('portBar');
            bar.style.width = barPct + '%';
            bar.style.background = isUp ? 'linear-gradient(90deg, #1b5e20, #4caf50)' : 'linear-gradient(90deg, #f44336, #b71c1c)';
            document.getElementById('portBarLabel').textContent = '$' + bal.toFixed(2);
            document.getElementById('lockedBtc').textContent = '$' + lBtc.toFixed(2);
            document.getElementById('lockedEth').textContent = '$' + lEth.toFixed(2);
            document.getElementById('pendingCount').textContent = (d.pendingCount || 0) + 'ê±´ ì§„í–‰ ì¤‘';
            document.getElementById('portTotal').textContent = '$' + totalAsset.toFixed(2);
            document.getElementById('portTotal').style.color = totalIsUp ? '#64b5f6' : '#f44336';
            document.getElementById('portTotalSub').textContent = 'ì”ì•¡ $' + bal.toFixed(2) + ' + ë°°íŒ… $' + totalLocked.toFixed(2);
            document.getElementById('portTotalBox').style.borderColor = totalIsUp ? '#1a1a3a' : '#3a1a1a';
            document.getElementById('portfolioCard').style.borderColor = isUp ? '#1a3a1a' : '#3a1a1a';
            document.getElementById('pnlTotal').textContent = 'PNL: ' + (isUp?'+$':'-$') + Math.abs(pnl).toFixed(2);
            document.getElementById('pnlTotal').style.color = isUp ? '#4caf50' : '#f44336';
        } catch(e) {}
    }

    // ===== ì´í€„ë¦¬í‹° ì»¤ë¸Œ =====
    async function drawEquityCurve() {
        const infoEl = document.getElementById('equityCurveInfo');
        try {
            const resp = await fetch('/balance/history');
            if (!resp.ok) { infoEl.textContent = 'âš ï¸ API ì˜¤ë¥˜: ' + resp.status; return; }
            const history = await resp.json();
            if (!history || !Array.isArray(history)) { infoEl.textContent = 'âš ï¸ ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜'; return; }
            if (history.length < 2) { infoEl.textContent = 'ë°°íŒ… í›„ ê·¸ë˜í”„ í‘œì‹œ (í˜„ì¬ ' + history.length + 'ê±´)'; return; }
            const canvas = document.getElementById('equityCanvas');
            const ctx = canvas.getContext('2d');
            const W = canvas.width, H = canvas.height;
            const pad = { top: 20, right: 20, bottom: 25, left: 50 };
            ctx.clearRect(0, 0, W, H);
            const balances = history.map(p => p.balance);
            const minB = Math.min(...balances) * 0.95;
            const maxB = Math.max(...balances) * 1.05;
            const range = maxB - minB || 1;
            const initial = balances[0];
            const chartW = W - pad.left - pad.right;
            const chartH = H - pad.top - pad.bottom;
            ctx.strokeStyle = '#1a1a1a'; ctx.lineWidth = 1;
            ctx.font = '10px monospace'; ctx.fillStyle = '#444';
            for (let i = 0; i <= 4; i++) {
                const y = pad.top + (chartH / 4) * i;
                const val = maxB - (range / 4) * i;
                ctx.beginPath(); ctx.moveTo(pad.left, y); ctx.lineTo(W - pad.right, y); ctx.stroke();
                ctx.fillText('$' + val.toFixed(1), 4, y + 4);
            }
            const iniY = pad.top + chartH * (1 - (initial - minB) / range);
            ctx.strokeStyle = '#333'; ctx.setLineDash([4, 4]);
            ctx.beginPath(); ctx.moveTo(pad.left, iniY); ctx.lineTo(W - pad.right, iniY); ctx.stroke();
            ctx.setLineDash([]); ctx.fillStyle = '#555'; ctx.fillText('ì›ê¸ˆ', W - pad.right - 25, iniY - 4);
            const points = history.map((p, i) => ({
                x: pad.left + (chartW / (history.length - 1)) * i,
                y: pad.top + chartH * (1 - (p.balance - minB) / range),
                event: p.event, coin: p.coin, balance: p.balance
            }));
            ctx.beginPath(); ctx.moveTo(points[0].x, iniY);
            points.forEach(p => ctx.lineTo(p.x, Math.min(p.y, iniY)));
            ctx.lineTo(points[points.length-1].x, iniY); ctx.closePath();
            ctx.fillStyle = 'rgba(76,175,80,0.08)'; ctx.fill();
            ctx.beginPath(); ctx.moveTo(points[0].x, iniY);
            points.forEach(p => ctx.lineTo(p.x, Math.max(p.y, iniY)));
            ctx.lineTo(points[points.length-1].x, iniY); ctx.closePath();
            ctx.fillStyle = 'rgba(244,67,54,0.08)'; ctx.fill();
            ctx.beginPath();
            ctx.strokeStyle = balances[balances.length-1] >= initial ? '#4caf50' : '#f44336';
            ctx.lineWidth = 2;
            points.forEach((p, i) => i === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y));
            ctx.stroke();
            points.forEach(p => {
                if (p.event === 'START') return;
                let color = p.event === 'WIN' ? '#4caf50' : p.event === 'LOSE' ? '#f44336' : p.coin === 'BTC' ? '#f7931a' : '#627eea';
                ctx.beginPath(); ctx.arc(p.x, p.y, p.event==='WIN'||p.event==='LOSE'?4:3, 0, Math.PI * 2);
                ctx.fillStyle = color; ctx.fill(); ctx.strokeStyle = '#0a0a0a'; ctx.lineWidth = 1; ctx.stroke();
            });
            const lastP = points[points.length - 1];
            ctx.fillStyle = balances[balances.length-1] >= initial ? '#4caf50' : '#f44336';
            ctx.font = 'bold 12px monospace';
            ctx.fillText('$' + lastP.balance.toFixed(2), lastP.x - 30, lastP.y - 8);
            const wins = history.filter(p => p.event === 'WIN').length;
            const loses = history.filter(p => p.event === 'LOSE').length;
            const bets = history.filter(p => p.event === 'BET').length;
            infoEl.textContent = `${bets}ê±´ ë°°íŒ… Â· ${wins}W ${loses}L Â· ìµœê³  $${Math.max(...balances).toFixed(2)} Â· ìµœì € $${Math.min(...balances).toFixed(2)}`;
            updateScenario(wins, loses, balances[balances.length-1], balances[0]);
        } catch(e) { infoEl.textContent = 'âš ï¸ ì˜¤ë¥˜: ' + e.message; }
    }

    function updateScenario(wins, loses, currentBal, initialBal) {
        const total = wins + loses;
        const el = document.getElementById('scenarioText');
        if (total < 2) { el.innerHTML = 'ìµœì†Œ 2ê±´ ì´ìƒ ê²°ê³¼ í™•ì • í›„ ì˜ˆì¸¡ í‘œì‹œ'; return; }
        const winRate = wins / total;
        const avgWin = currentBal > initialBal ? (currentBal - initialBal) / wins : initialBal * 0.04;
        const avgLoss = loses > 0 ? Math.abs(currentBal - initialBal - wins * avgWin) / loses : initialBal * 0.05;
        const avgBetPnl = winRate * avgWin - (1 - winRate) * avgLoss;
        const expectedBets12h = 24;
        const optimistic = currentBal + expectedBets12h * Math.abs(avgBetPnl) * 1.5;
        const expected = currentBal + expectedBets12h * avgBetPnl;
        const pessimistic = currentBal - expectedBets12h * Math.abs(avgBetPnl) * 0.5;
        const fmt = v => (v >= 0 ? '$' : '-$') + Math.abs(v).toFixed(2);
        const clr = v => v >= initialBal ? '#4caf50' : '#f44336';
        el.innerHTML = `<div style="display:flex; gap:12px;">
            <span>ğŸŸ¢ ë‚™ê´€: <b style="color:${clr(optimistic)}">${fmt(optimistic)}</b></span>
            <span>ğŸŸ¡ ì˜ˆìƒ: <b style="color:${clr(expected)}">${fmt(expected)}</b></span>
            <span>ğŸ”´ ë¹„ê´€: <b style="color:${clr(pessimistic)}">${fmt(Math.max(0, pessimistic))}</b></span>
        </div><div style="font-size:9px; color:#444; margin-top:3px;">í˜„ì¬ ìŠ¹ë¥  ${(winRate*100).toFixed(0)}% Â· í‰ê·  ë°°íŒ…ë‹¹ ${avgBetPnl >= 0 ? '+' : ''}$${avgBetPnl.toFixed(2)} Â· 12h ì˜ˆìƒ ${expectedBets12h}ê±´</div>`;
    }

    function refreshTimeMarkers() { loadTriggers(); }

    // ===== ì˜¤ì¦ˆ í¬ë§· í—¬í¼ =====
    function formatCents(v) {
        if (v == null) return '50Â¢';
        // ì •ìˆ˜ë©´ ì •ìˆ˜ë¡œ, ì•„ë‹ˆë©´ ì†Œìˆ˜ì  1ìë¦¬
        return (v === Math.floor(v) ? v : v.toFixed(1)) + 'Â¢';
    }
    function oddsBarWidth(pct) {
        // ìµœì†Œ 3% ë„ˆë¹„ ë³´ì¥ (ê·¹ë‹¨ê°’ì—ì„œë„ ë°”ê°€ ë³´ì´ë„ë¡)
        return Math.max(3, Math.min(97, pct || 50)) + '%';
    }
    function oddsFontSize(cents) {
        // ê·¹ë‹¨ê°’ì¼ ë•Œ í°íŠ¸ ì‚´ì§ ì¤„ì„
        if (cents != null && (cents <= 2 || cents >= 98)) return '18px';
        return '24px';
    }

    // ===== ì˜¤ì¦ˆ (ë²Œí¬ API â€” 1ì´ˆ í´ë§) =====
    async function refreshOdds() {
        const timeEl = document.getElementById('oddsTime');
        timeEl.style.color = '#4caf50';
        setTimeout(() => timeEl.style.color = '#444', 200);
        try {
            const data = await fetch('/odds/all').then(r => r.json());
            const now = new Date().toLocaleTimeString('ko-KR', {hour:'2-digit',minute:'2-digit',second:'2-digit'});

            // 1H ì˜¤ì¦ˆ ì—…ë°ì´íŠ¸
            if (data['1H']) {
                for (const coin of ['BTC', 'ETH', 'SOL', 'XRP']) {
                    const d = data['1H'][coin];
                    if (!d) continue;
                    const prefix = coin.toLowerCase();
                    const upEl = document.getElementById(prefix + 'UpOdds');
                    const downEl = document.getElementById(prefix + 'DownOdds');
                    if (!upEl || !downEl) continue;
                    upEl.textContent = formatCents(d.upCents);
                    downEl.textContent = formatCents(d.downCents);
                    upEl.style.fontSize = oddsFontSize(d.upCents);
                    downEl.style.fontSize = oddsFontSize(d.downCents);
                    const upBar = document.getElementById(prefix + 'UpBar');
                    const downBar = document.getElementById(prefix + 'DownBar');
                    if (upBar) upBar.style.width = oddsBarWidth(d.upPct);
                    if (downBar) downBar.style.width = oddsBarWidth(d.downPct);
                    const slugEl = document.getElementById(prefix + 'OddsSlug');
                    if (slugEl) slugEl.textContent = (d.slug || '') + (d.spread > 0 ? '  |  ìŠ¤í”„ë ˆë“œ: ' + d.spread + 'Â¢' : '');
                    const statusEl = document.getElementById(prefix + 'OddsStatus');
                    if (statusEl) statusEl.innerHTML = d.available
                        ? '<span style="color:#4caf50;">â— LIVE</span>'
                        : '<span style="color:#f44336;">â— ë§ˆì¼“ ì—†ìŒ</span>';
                }
            }
            timeEl.textContent = now;

            // 15M ì˜¤ì¦ˆ ì—…ë°ì´íŠ¸
            const time15mEl = document.getElementById('odds15mTime');
            if (data['15M']) {
                for (const coin of ['BTC', 'ETH', 'SOL', 'XRP']) {
                    const d = data['15M'][coin];
                    if (!d) continue;
                    const prefix = coin.toLowerCase() + '15m';
                    const upEl = document.getElementById(prefix + 'UpOdds');
                    const downEl = document.getElementById(prefix + 'DownOdds');
                    if (!upEl || !downEl) continue;
                    upEl.textContent = formatCents(d.upCents);
                    downEl.textContent = formatCents(d.downCents);
                    upEl.style.fontSize = oddsFontSize(d.upCents);
                    downEl.style.fontSize = oddsFontSize(d.downCents);
                    const upBar = document.getElementById(prefix + 'UpBar');
                    const downBar = document.getElementById(prefix + 'DownBar');
                    if (upBar) upBar.style.width = oddsBarWidth(d.upPct);
                    if (downBar) downBar.style.width = oddsBarWidth(d.downPct);
                    const slugEl = document.getElementById(prefix + 'OddsSlug');
                    if (slugEl) slugEl.textContent = d.slug || '';
                    const statusEl = document.getElementById(prefix + 'OddsStatus');
                    if (statusEl) statusEl.innerHTML = d.available
                        ? '<span style="color:#4caf50;">â— LIVE</span>'
                        : '<span style="color:#f44336;">â— ë§ˆì¼“ ì—†ìŒ</span>';
                }
            }
            if (time15mEl) time15mEl.textContent = now;

            // 5M ì˜¤ì¦ˆ ì—…ë°ì´íŠ¸
            const time5mEl = document.getElementById('odds5mTime');
            if (data['5M']) {
                for (const coin of ['BTC', 'ETH', 'SOL', 'XRP']) {
                    const d = data['5M'][coin];
                    if (!d) continue;
                    const prefix = coin.toLowerCase() + '5m';
                    const upEl = document.getElementById(prefix + 'UpOdds');
                    const downEl = document.getElementById(prefix + 'DownOdds');
                    if (!upEl || !downEl) continue;
                    upEl.textContent = formatCents(d.upCents);
                    downEl.textContent = formatCents(d.downCents);
                    upEl.style.fontSize = oddsFontSize(d.upCents);
                    downEl.style.fontSize = oddsFontSize(d.downCents);
                    const upBar = document.getElementById(prefix + 'UpBar');
                    const downBar = document.getElementById(prefix + 'DownBar');
                    if (upBar) upBar.style.width = oddsBarWidth(d.upPct);
                    if (downBar) downBar.style.width = oddsBarWidth(d.downPct);
                    const slugEl = document.getElementById(prefix + 'OddsSlug');
                    if (slugEl) slugEl.textContent = d.slug || '';
                    const statusEl = document.getElementById(prefix + 'OddsStatus');
                    if (statusEl) statusEl.innerHTML = d.available
                        ? '<span style="color:#4caf50;">â— LIVE</span>'
                        : '<span style="color:#f44336;">â— ë§ˆì¼“ ì—†ìŒ</span>';
                }
            }
            if (time5mEl) time5mEl.textContent = now;
        } catch(e) {
            // ê°œë³„ ìƒíƒœ í‘œì‹œëŠ” ìƒëµ â€” ì „ì²´ ì‹¤íŒ¨ ì‹œ ë‹¤ìŒ tickì—ì„œ ë³µêµ¬
        }
    }

    // ===== ì˜¤ì¦ˆ ê°­ ëª¨ë‹ˆí„° (1ì´ˆ í´ë§) =====
    let _lastGapHtml = '';
    async function refreshGaps() {
        try {
            const data = await fetch('/gaps').then(r => r.json());
            const grid = document.getElementById('gapGrid');
            const coins = ['BTC', 'ETH', 'SOL', 'XRP'];
            const timeframes = ['1H', '15M', '5M'];
            const coinIcons = { BTC: 'â‚¿', ETH: 'Î', SOL: 'â—', XRP: 'âœ•' };
            const coinColors = { BTC: '#f7931a', ETH: '#627eea', SOL: '#00d4aa', XRP: '#00aaff' };

            let html = '';
            let hasOpportunity = false;

            for (const coin of coins) {
                let cellHtml = `<div style="background:#111; border:1px solid #222; border-radius:8px; padding:10px;">`;
                cellHtml += `<div style="color:${coinColors[coin]}; font-weight:bold; font-size:13px; margin-bottom:8px;">${coinIcons[coin]} ${coin}</div>`;

                for (const tf of timeframes) {
                    const key = coin + '_' + tf;
                    const g = data[key];

                    if (!g || g.age > 10) {
                        cellHtml += `<div style="padding:4px 0; border-bottom:1px solid #1a1a1a;">
                            <span style="font-size:10px; color:#444;">${tf} â€” ëŒ€ê¸°</span>
                        </div>`;
                        continue;
                    }

                    const dirIcon = g.direction === 'UP' ? 'â¬†' : 'â¬‡';

                    // === ìˆœë°©í–¥ ê°­ ===
                    const fwdGapPct = g.gapPct || 0;
                    const fwdColor = fwdGapPct >= 8 ? '#4caf50' : fwdGapPct > 0 ? '#2e7d32' : '#555';
                    const fwdDots = g.streakSeconds >= 3 ? 'ğŸ”¥' : g.streakSeconds >= 1 ? 'â€¢'.repeat(g.streakSeconds) : '';

                    // === â­ ì—­ë°©í–¥ ê°­ (í•µì‹¬!) ===
                    const revGapPct = g.reverseGapPct || 0;
                    const revDir = g.reverseDirection || '';
                    const revIcon = revDir === 'UP' ? 'â¬†' : revDir === 'DOWN' ? 'â¬‡' : '';
                    const isRevHot = revGapPct >= 10;
                    const isRevBurning = revGapPct >= 15;
                    if (isRevHot) hasOpportunity = true;
                    if (fwdGapPct >= 8) hasOpportunity = true;

                    const revColor = isRevBurning ? '#ff9800' : isRevHot ? '#e040fb' : revGapPct > 0 ? '#7b1fa2' : '#333';
                    const revBg = isRevBurning ? '#1a1200' : isRevHot ? '#1a0a1a' : '#0d0d0d';
                    const revGlow = isRevBurning ? 'box-shadow:0 0 8px #ff980030;' : '';
                    const revDots = (g.reverseStreakSeconds || 0) >= 3 ? 'ğŸ”¥' : (g.reverseStreakSeconds || 0) >= 1 ? 'â€¢'.repeat(g.reverseStreakSeconds) : '';

                    cellHtml += `<div style="padding:5px 0; border-bottom:1px solid #1a1a1a;">
                        <div style="font-size:10px; color:#666; margin-bottom:3px;">${tf} ${dirIcon} ${g.priceDiffPct > 0 ? '+' : ''}${g.priceDiffPct.toFixed(2)}%</div>
                        <div style="display:flex; justify-content:space-between; gap:6px;">
                            <!-- ìˆœë°©í–¥ -->
                            <div style="flex:1; background:#0d0d0d; border:1px solid ${fwdGapPct >= 8 ? '#4caf5040' : '#1a1a1a'}; border-radius:4px; padding:4px 6px; text-align:center;">
                                <div style="font-size:8px; color:#555;">ìˆœë°©í–¥${dirIcon}</div>
                                <div style="font-size:14px; font-weight:bold; color:${fwdColor};">${fwdGapPct >= 0 ? '+' : ''}${fwdGapPct.toFixed(1)}%</div>
                                <div style="font-size:8px; color:#444;">${fwdDots}</div>
                            </div>
                            <!-- ì—­ë°©í–¥ â­ -->
                            <div style="flex:1; background:${revBg}; border:1px solid ${isRevHot ? revColor + '50' : '#1a1a1a'}; border-radius:4px; padding:4px 6px; text-align:center; ${revGlow}">
                                <div style="font-size:8px; color:#888;">ì—­ë°©í–¥${revIcon}</div>
                                <div style="font-size:14px; font-weight:bold; color:${revColor};">${revGapPct >= 0 ? '+' : ''}${revGapPct.toFixed(1)}%</div>
                                <div style="font-size:8px; color:#444;">${revDots}</div>
                            </div>
                        </div>
                        <div style="font-size:8px; color:#333; margin-top:2px; text-align:center;">
                            ì¶”ì •${(g.estimatedProb * 100).toFixed(0)}% vs ì˜¤ì¦ˆ${(g.marketOdds * 100).toFixed(0)}%
                            ${isRevHot ? ' | ğŸ”„ì—­' + (g.reverseEstProb * 100).toFixed(0) + '% vs ' + (g.reverseMarketOdds * 100).toFixed(0) + 'Â¢' : ''}
                        </div>
                    </div>`;
                }

                cellHtml += '</div>';
                html += cellHtml;
            }

            if (html !== _lastGapHtml) { grid.innerHTML = html; _lastGapHtml = html; }
            const badge = document.getElementById('gapAlertBadge');
            badge.style.display = hasOpportunity ? 'inline' : 'none';
            document.getElementById('gapTime').textContent =
                new Date().toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit', second:'2-digit'});
        } catch(e) {}
    }

    // ===== AI êµí›ˆ =====
    async function refreshLessons() {
        try {
            const lessons = await fetch('/lessons').then(r => r.json());
            const grid = document.getElementById('lessonsGrid');
            if (!lessons || lessons.length === 0) {
                grid.innerHTML = '<div style="color:#444; font-size:11px; padding:10px; grid-column:1/-1;">ë°˜ì„± 5ê±´ ì´ìƒ ëˆ„ì  í›„ AIê°€ êµí›ˆì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤</div>';
                return;
            }
            grid.innerHTML = lessons.map(l => {
                const imp = l.importance >= 0.8 ? 'ğŸ”´' : l.importance >= 0.5 ? 'ğŸŸ¡' : 'âšª';
                const catColor = {
                    'RSI': '#ff6b6b', 'FUNDING': '#ffd93d', 'TIMING': '#6bcbff',
                    'TREND': '#4caf50', 'STREAK': '#ff9800', 'OI': '#ce93d8', 'GENERAL': '#888'
                }[l.category] || '#888';
                const updated = l.updatedAt ? new Date(l.updatedAt).toLocaleString('ko-KR', {month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}) : '';
                return `<div style="background:#111; border:1px solid #222; border-radius:6px; padding:10px 12px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                        <span style="font-size:10px; padding:1px 6px; border-radius:3px; background:#1a1a1a; color:${catColor}; border:1px solid ${catColor}40;">${l.category}</span>
                        <span style="font-size:9px; color:#444;">${imp} ${l.evidenceCount}ê±´ ê·¼ê±°</span>
                    </div>
                    <div style="font-size:11px; color:#ccc; line-height:1.5;">${l.lesson}</div>
                    <div style="font-size:9px; color:#333; margin-top:4px;">${updated}</div>
                </div>`;
            }).join('');
            document.getElementById('lessonsFooter').innerHTML =
                `ğŸ’¡ ${lessons.length}ê°œ êµí›ˆ í™œì„± Â· ì¤‘ìš”ë„ìˆœ ì •ë ¬ Â· ë§¤ íŒë‹¨ì— ìë™ ë°˜ì˜`;
        } catch(e) {}
    }

    async function compressLessons() {
        addLog('ğŸ§  AI êµí›ˆ ì••ì¶• ì‹œì‘...');
        await fetch('/lessons/compress', {method:'POST'});
        setTimeout(refreshLessons, 8000); // ì••ì¶• ì™„ë£Œ í›„ ìƒˆë¡œê³ ì¹¨
    }

    // ===== â­ V5: ê°­ìŠ¤ìºë„ˆ ì‹¤ì‹œê°„ í™œë™ ë¡œê·¸ =====
    const coinColors2 = { BTC: '#f7931a', ETH: '#627eea', SOL: '#00d4aa', XRP: '#00aaff' };
    let _lastScanHtml = '';
    async function refreshScanLogs() {
        try {
            const logs = await fetch('/scan-logs').then(r => r.json());
            const box = document.getElementById('scanLogBox');
            const timeEl = document.getElementById('scanLogTime');
            timeEl.textContent = new Date().toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit', second:'2-digit'});

            if (!logs || logs.length === 0) {
                box.innerHTML = '<div style="font-size:10px; color:#555;">ìŠ¤ìº” ëŒ€ê¸°ì¤‘...</div>';
                return;
            }
            let html = '';
            for (const l of logs.slice(0, 30)) {
                const t = new Date(l.time).toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit', second:'2-digit'});
                const cc = coinColors2[l.coin] || '#888';
                const isAction = l.stage.includes('ë°°íŒ…') || l.stage.includes('ê°­!');
                const isBrk = l.stage.includes('ì„œí‚·');
                const isWait = l.stage.includes('ì—°ì†');
                const stageColor = isAction ? '#4caf50' : isBrk ? '#f44336' : isWait ? '#ff9800' : '#666';
                html += `<div style="font-size:10px; line-height:1.7; border-bottom:1px solid #111; padding:1px 0;">` +
                    `<span style="color:#444;">${t}</span> ` +
                    `<span style="color:${cc}; font-weight:bold;">${l.coin}</span>` +
                    `<span style="color:#444;"> ${l.tf}</span> ` +
                    `<span style="color:${stageColor}; font-weight:${isAction ? 'bold' : 'normal'};">${l.stage}</span> ` +
                    `<span style="color:#555;">${l.detail}</span></div>`;
            }
            if (html !== _lastScanHtml) { box.innerHTML = html; _lastScanHtml = html; }
        } catch(e) {}
    }

    // ===== ì´ˆê¸°í™” & í´ë§ =====
    refreshAllIndicators();
    refreshOdds();
    refreshGaps();
    refreshAllStats();
    refreshAllTrades();
    loadTriggers();
    refreshBalance();
    drawEquityCurve();
    refreshLessons();
    refreshScanLogs();
    initChart('BTCUSDT');
    initChart15m('BTCUSDT');

    setInterval(tickPrice, 1000);
    setInterval(refreshGaps, 1000);
    setInterval(refreshScanLogs, 1000);
    setInterval(refreshAllIndicators, 30000);
    setInterval(refreshOdds, 1000);
    setInterval(refreshAllStats, 30000);
    setInterval(refreshAllTrades, 15000);
    setInterval(refreshTimeMarkers, 60000);
    setInterval(refreshBalance, 15000);
    setInterval(drawEquityCurve, 60000);
    setInterval(refreshLessons, 60000);
</script>
</body>
</html>
